{
  "UserSystemModule": [
    {
      "Key": "P_Order_QueryBonusOrderList",
      "Desc": "中奖查询",
      "ParamDesc": "@userId:userId,@gameCode:gameCode,@gameType:gameType,@issuseNumber:issuseNumber,@completeData:completeData,@key:key,@pageIndex:pageIndex,@pageSize:pageSize,@totalCount:totalCount",
      "Director": "Debug",
      "SQL": "SET NOCOUNT ON; select @TotalCount=0 SELECT * FROM ( SELECT ROW_NUMBER() OVER(ORDER BY ComplateDateTime DESC) AS [RowNumber],[SchemeId],[GameCode],[GameType],[PlayType],[SchemeType],[IssuseNumber],[Amount],[BetCount],[TotalMatchCount],[TotalMoney],[TicketStatus],[ProgressStatus] ,[BonusStatus],[PreTaxBonusMoney],[AfterTaxBonusMoney],ISNULL([IsVirtualOrder],1) [IsVirtualOrder],O.[CreateTime],[BonusCount],BonusCountDescription,BonusCountDisplayName,[ComplateDateTime],[ComplateDate],[IsPrizeMoney],O.[AgentId] ,O.[UserId],R.DisplayName,R.IsAgent,R.HideDisplayNameCount FROM [C_Sports_Order_Complate] O LEFT OUTER JOIN C_User_Register R ON R.UserId=O.UserId WHERE [BonusStatus]=20 AND AfterTaxBonusMoney>2000 AND IsVirtualOrder=0 AND (@UserId='' OR O.[UserId]=@UserId) AND (@GameCode='' OR [GameCode]=@GameCode) ) T WHERE [RowNumber] > @PageIndex * @PageSize AND [RowNumber] <= (@PageIndex + 1) * @PageSize",
      "Remark": "备注"
    },
    {
      "Key": "Debug_AccountDetail",
      "Desc": "资金明细",
      "ParamDesc": "@UserId:userId,@StartTime:fromDate,@EndTime:toDate,@PageIndex:pageIndex,@PageSize:pageSize",
      "Director": "Debug",
      "SQL": "SELECT * FROM (SELECT ROW_NUMBER() OVER(ORDER BY f.id DESC)ROWINDEX,f.id,f.UserId,f.AccountType,f.Category,f.KeyLine,f.OperatorId,f.PayType,f.Summary,f.OrderId,f.BeforeBalance,f.PayMoney,f.AfterBalance,f.CreateTime FROM C_Fund_Detail f WHERE f.UserId=@UserId) and (f.CreateTime>=@StartTime and f.CreateTime<@EndTime) ) T  WHERE RowIndex > @PageIndex * @PageSize AND RowIndex <= (@PageIndex + 1) * @PageSize",
      "Remark": ""
    },
    {
      "key": "Debug_IncomeAndMoney",
      "Desc": "收入/支出条数和金额",
      "ParamDesc": "@UserId:userId,@StartTime:fromDate,@EndTime:toDate",
      "Director": "Debug",
      "SQL": "select count(1) PayCount, isnull(sum(f.PayMoney),0)TotalPayMoney from C_Fund_Detail f where f.UserId=@UserId and (f.CreateTime>=@StartTime and f.CreateTime<@EndTime) and f.PayType=20",
      "Remark": ""
    },
    {
      "key": "Debug_OutAndMoney",
      "Desc": "收入/支出条数和金额",
      "ParamDesc": "@UserId:userId,@StartTime:fromDate,@EndTime:toDate",
      "Director": "Debug",
      "SQL": "select count(1) PayCount, isnull(sum(f.PayMoney),0)TotalPayMoney from C_Fund_Detail f where f.UserId=@UserId and (f.CreateTime>=@StartTime and f.CreateTime<@EndTime) and f.PayType=10",
      "Remark": ""
    },
    {
      "key": "Debug_TotalRequestMoney",
      "Desc": "充值记录金额",
      "ParamDesc": "@UserId:userId,@AgentList:agentTypeList,@StatusList:statusList,@SourceList:sourceList,@StartTime:startTime,@EndTime:endTime,@OrderId:OrderId",
      "Director": "Debug",
      "SQL": "SELECT TotalCount=COUNT(1),TotalRequestMoney=SUM(RequestMoney) FROM C_FillMoney WHERE UserId=@UserId AND (@AgentList=N'' OR FillMoneyAgent IN ({0})) AND (@StatusList=N'' OR [Status] IN ({1})) AND (@SourceList=N'' OR SchemeSource IN ({2})) And (RequestTime>=@StartTime AND RequestTime < @EndTime) And (@OrderId='' or (OrderId=@OrderId or OuterFlowId=@OrderId))",
      "Remark": ""
    },
    {
      "key": "Debug_TotalResponseMoney",
      "Desc": "充值记录金额",
      "ParamDesc": "@UserId:userId,@AgentList:agentTypeList,@SourceList:sourceList,@StartTime:startTime,@EndTime:endTime,@OrderId:OrderId",
      "Director": "Debug",
      "SQL": "SELECT TotalResponseMoney=SUM(ResponseMoney) FROM C_FillMoney WHERE  UserId=@UserId AND (@AgentList=N'' OR FillMoneyAgent IN ({0})) AND [Status]=1 AND (@SourceList=N'' OR SchemeSource IN (1)) ANd (RequestTime>=@StartTime AND RequestTime < @EndTime) and (@OrderId='' or (OrderId=@OrderId or OuterFlowId=@OrderId))",
      "Remark": ""
    },
    {
      "key": "Debug_FillMoneyPage",
      "Desc": "充值记录分页",
      "ParamDesc": "@UserId:userId,@AgentList:agentTypeList,@SourceList:sourceList,@StartTime:startTime,@EndTime:endTime,@OrderId:OrderId",
      "Director": "Debug",
      "SQL": "SELECT * FROM( SELECT ROW_NUMBER()OVER(ORDER BY RequestTime DESC) RowIndex,T.*,R.ComeFrom,R.VipLevel,DisplayName,R.HideDisplayNameCount FROM C_FillMoney T LEFT OUTER JOIN C_User_Register R ON T.UserId=R.UserId WHERE T.UserId=@UserId) AND (@AgentList=N'' OR FillMoneyAgent IN ({0})) AND (@StatusList=N'' OR [Status] IN ({1})) AND (@SourceList=N'' OR SchemeSource IN ({2})) ANd (RequestTime>=@StartTime AND RequestTime < @EndTime)  and (@OrderId='' or (OrderId=@OrderId or OuterFlowId=@OrderId)) ) T WHERE RowIndex > @PageIndex * @PageSize AND RowIndex <= (@PageIndex + 1) * @PageSize",
      "Remark": ""
    },
    {
      "key": "Debug_MyBettingOrder",
      "Desc": "我的投注记录",
      "ParamDesc": "@UserId:userId,@BonusStatus:bonusStatus,@GameCode:gameCode,@FromDate:startTime,@ToDate:endTime",
      "Director": "Debug",
      "SQL": "SELECT TotalCount=COUNT(1), TotalBuyMoney=SUM(o.CurrentBettingMoney), TotalBonusMoney=SUM(o.AfterTaxBonusMoney) FROM [C_OrderDetail] o WHERE o.SchemeType in (1,7) and o.UserId=@UserId AND (@BonusStatus=-1 OR BonusStatus=@BonusStatus) AND (@GameCode=N'' OR GameCode=@GameCode) AND (@FromDate=N'' OR o.CreateTime>=@FromDate) AND (@ToDate=N'' OR o.CreateTime<@ToDate)",
      "Remark": ""
    },
    {
      "key": "Debug_MyBettingOrderPage",
      "Desc": "我的投注记录",
      "ParamDesc": "@UserId:userId,@BonusStatus:bonusStatus,@GameCode:gameCode,@FromDate:startTime,@ToDate:endTime,@PageIndex:pageIndex,@PageSize:pageSize",
      "Director": "Debug",
      "SQL": "SELECT * FROM ( SELECT ROW_NUMBER() OVER(ORDER BY  o.CreateTime DESC, StartIssuseNumber) AS [RowNumber], o.SchemeId,o.UserId,r.VipLevel,r.DisplayName CreatorDisplayName,r.HideDisplayNameCount, o.UserId as JoinUserId,'1' as JoinSucess, GameCode,GameTypeName,SchemeType,SchemeSource,SchemeBettingCategory, o.CreateTime as BuyTime, o.CurrentBettingMoney BuyMoney, TotalMoney,ProgressStatus,TicketStatus ,TotalIssuseCount,StartIssuseNumber IssuseNumber,BonusStatus,IsVirtualOrder, o.PreTaxBonusMoney as PreTaxBonusMoney, o.AfterTaxBonusMoney as AfterTaxBonusMoney, StopAfterBonus,o.AddMoney as AddMoney, o.RedBagMoney RedBagMoney, o.RedBagAwardsMoney RedBagAwardsMoney, o.BonusAwardsMoney BonusAwardsMoney FROM [C_OrderDetail] o LEFT OUTER JOIN C_User_Register r ON r.UserId=o.UserId WHERE o.SchemeType in (1,7) and o.UserId=@UserId AND (@BonusStatus=-1 OR BonusStatus=@BonusStatus) AND (@GameCode=N'' OR GameCode=@GameCode) AND (@FromDate=N'' OR o.CreateTime>=@FromDate) AND (@ToDate=N'' OR o.CreateTime<@ToDate) ) T WHERE [RowNumber] > @PageIndex * @PageSize AND [RowNumber] <= (@PageIndex + 1) * @PageSize",
      "Remark": ""
    },
    {
      "key": "Debug_QueryCreateTogetherOrderCount",
      "Desc": "查询指定用户创建的合买订单列表统计",
      "ParamDesc": "@UserId:userId,@DateFrom:startTime,@DateTo:endTime,@GameCode:gameCode",
      "Director": "Debug",
      "SQL": "SELECT TotalCount=COUNT(1), TotalBuyMoney=0, TotalOrderMoney=0 FROM C_Sports_Together O WHERE O.CreateUserId=@UserId AND O.CreateTime BETWEEN @DateFrom AND @DateTo and (@GameCode='' or o.GameCode=@GameCode)",
      "Remark": ""
    },
    {
      "key": "Debug_QueryCreateTogetherOrderPage",
      "Desc": "查询指定用户创建的合买订单列表",
      "ParamDesc": "@UserId:userId,@DateFrom:startTime,@DateTo:endTime,@GameCode:gameCode,@PageIndex:pageIndex,@PageSize:pageSize",
      "Director": "Debug",
      "SQL": "SELECT * FROM( SELECT ROW_NUMBER()OVER(ORDER BY O.CreateTime DESC) RowIndex,O.SchemeId,O.SchemeType,O.UserId,O.GameCode, T.GameType,O.GameTypeName,O.StartIssuseNumber,O.TotalMoney,O.ProgressStatus,O.AddMoney, O.TicketStatus,O.BonusStatus,O.IsVirtualOrder,O.PreTaxBonusMoney,O.AfterTaxBonusMoney,O.CreateTime ,T.ProgressStatus TogetherSchemeProgress,T.Progress,ISNULL(C.IsPrizeMoney,0) IsPrizeMoney FROM C_Sports_Together T INNER JOIN C_OrderDetail O ON O.SchemeId=T.SchemeId LEFT OUTER JOIN C_Sports_Order_Complate C ON C.SchemeId=T.SchemeId LEFT OUTER JOIN C_User_Register R ON O.UserId=R.UserId WHERE T.CreateUserId=@UserId AND T.CreateTime BETWEEN @DateFrom AND @DateTo and (@GameCode='' or o.GameCode=@GameCode) and (@BonusStatus=-1 or o.BonusStatus=@BonusStatus) ) T WHERE RowIndex > @PageIndex * @PageSize AND RowIndex <= (@PageIndex + 1) * @PageSize",
      "Remark": ""
    },
    {
      "key": "Debug_QueryJoinTogetherOrderCount",
      "Desc": "查询指定用户参与的合买订单统计",
      "ParamDesc": "@GameCode:gameCode",
      "Director": "Debug",
      "SQL": "SELECT * FROM( SELECT ROW_NUMBER()OVER(ORDER BY O.CreateTime DESC) RowIndex,O.SchemeId,O.SchemeType,O.UserId,O.GameCode, T.GameType,O.GameTypeName,O.StartIssuseNumber,O.TotalMoney,O.ProgressStatus,O.AddMoney, O.TicketStatus,O.BonusStatus,O.IsVirtualOrder,O.PreTaxBonusMoney,O.AfterTaxBonusMoney,O.CreateTime ,T.ProgressStatus TogetherSchemeProgress,T.Progress,ISNULL(C.IsPrizeMoney,0) IsPrizeMoney FROM C_Sports_Together T INNER JOIN C_OrderDetail O ON O.SchemeId=T.SchemeId LEFT OUTER JOIN C_Sports_Order_Complate C ON C.SchemeId=T.SchemeId LEFT OUTER JOIN C_User_Register R ON O.UserId=R.UserId WHERE T.CreateUserId=@UserId AND T.CreateTime BETWEEN @DateFrom AND @DateTo and (@GameCode='' or o.GameCode=@GameCode) and (@BonusStatus=-1 or o.BonusStatus=@BonusStatus) ) T WHERE RowIndex > @PageIndex * @PageSize AND RowIndex <= (@PageIndex + 1) * @PageSize",
      "Remark": ""
    },
    {
      "key": "Debug_QueryJoinTogetherOrderPage",
      "Desc": "查询指定用户参与的合买订单列表",
      "ParamDesc": "@UserId:userId,@DateFrom:startTime,@DateTo:endTime,@GameCode:gameCode,@BonusStatus:bonus,@PageIndex:pageIndex,@PageSize:pageSize",
      "Director": "Debug",
      "SQL": "SELECT * FROM( SELECT ROW_NUMBER()OVER(ORDER BY ISNULL(S.CreateTime,O.CreateTime) DESC) RowIndex,O.SchemeId,O.SchemeType,O.UserId,O.GameCode,T.GameType,O.GameTypeName,O.StartIssuseNumber,O.TotalMoney,O.ProgressStatus,O.TicketStatus,O.BonusStatus,O.IsVirtualOrder,O.PreTaxBonusMoney,O.AfterTaxBonusMoney,O.AddMoney ,T.ProgressStatus TogetherSchemeProgress,T.Progress,ISNULL(C.IsPrizeMoney,0) IsPrizeMoney,S.BuyMoney JoinMoney,ISNULL(S.CreateTime,O.CreateTime) CreateTime ,R.VipLevel,DisplayName,R.HideDisplayNameCount FROM ( SELECT J.SchemeId,JoinUserId UserId,CONVERT(MONEY, SUM(RealBuyCount)) BuyMoney,MIN(CreateTime) CreateTime FROM C_Sports_TogetherJoin J WHERE JoinUserId=@UserId AND (CreateTime BETWEEN @DateFrom AND @DateTo) AND JoinSucess=1 AND J.JoinType IN (2,3) GROUP BY J.SchemeId,JoinUserId ) S INNER JOIN C_OrderDetail O ON S.SchemeId=O.SchemeId INNER JOIN C_Sports_Together T ON S.SchemeId=T.SchemeId LEFT OUTER JOIN C_Sports_Order_Complate C ON S.SchemeId=C.SchemeId LEFT OUTER JOIN C_User_Register R ON O.UserId=R.UserId where (@GameCode='' or O.GameCode=@GameCode) and (@BonusStatus=-1 or o.BonusStatus=@BonusStatus) ) T WHERE RowIndex > @PageIndex * @PageSize AND RowIndex <= (@PageIndex + 1) * @PageSize",
      "Remark": ""
    }

  ],
  "DataModule": [
    {
      "key": "Data_QueryArticleList",
      "Desc": "查询文章列表",
      "ParamDesc": "@Key:key,@GameCode:gameCode,@Category:category,@PageIndex:pageIndex,@PageSize:pageSize",
      "Director": "lili",
      "SQL": "SELECT [Id],[GameCode],[Title],[Category],[ShowIndex],[ReadCount],[CreateTime],[CreateUserKey],[CreateUserDisplayName], [UpdateTime],[UpdateUserKey],[UpdateUserDisplayName],[IsRedTitle],KeyWords,DescContent,StaticPath,PreStaticPath,NextStaticPath,Description FROM ( SELECT ROW_NUMBER() OVER(ORDER BY [ShowIndex] ASC, [CreateTime] DESC) AS [RowNumber],[Id],[GameCode],[Title],[Category], [ShowIndex],[ReadCount],[CreateTime],[CreateUserKey],[CreateUserDisplayName],[UpdateTime], [UpdateUserKey],[UpdateUserDisplayName],[IsRedTitle],KeyWords,DescContent,StaticPath,PreStaticPath,NextStaticPath,Description FROM [E_SiteMessage_Article_List] WHERE (@Key = '' OR [Title] LIKE @Key) AND (@GameCode = '' OR [GameCode] LIKE '%' + @GameCode) AND (@Category=N'' OR [Category] IN (SELECT a FROM F_Common_SplitString(@Category,'|'))) ) AS [T] WHERE [RowNumber] > @PageIndex * @PageSize AND [RowNumber] <= (@PageIndex + 1) * @PageSize",
      "Remark": ""
    },
    {
      "key": "Data_QueryArticleList_TotalCount",
      "Desc": "查询文章列表_总条数",
      "ParamDesc": "@Key:key,@GameCode:gameCode,@Category:category",
      "Director": "lili",
      "SQL": "SELECT @TotalCount = COUNT(1) FROM [E_SiteMessage_Article_List] WHERE (@Key = '' OR [Title] LIKE @Key) AND (@Category=N'' OR [Category] IN (SELECT a FROM F_Common_SplitString(@Category,'|'))) AND (@GameCode = '' OR [GameCode] LIKE '%' + @GameCode)",
      "Remark": ""
    },
    {
      "key": "Data_QueryBulletinList_Web",
      "Desc": "用户查询公告列表",
      "ParamDesc": "@BulletinAgent:bulletinAgent,@PageIndex:pageIndex,@PageSize:pageSize",
      "Director": "lili",
      "SQL": "SELECT [Id],[Title],[Status],[Priority],[IsPutTop],[EffectiveFrom],[EffectiveTo],[CreateTime] FROM ( SELECT ROW_NUMBER() OVER(ORDER BY [IsPutTop] DESC,[Priority],[CreateTime] DESC) AS [RowNumber],[Id],[Title],[Status],[Priority],[IsPutTop],[EffectiveFrom],[EffectiveTo],[CreateTime] FROM [E_SiteMessage_Bulletin_List] WHERE [Status] = 0 AND (BulletinAgent=@BulletinAgent) AND ([EffectiveFrom] IS NULL OR [EffectiveFrom] <= GETDATE()) AND ([EffectiveTo] IS NULL OR DATEADD(DAY,1,[EffectiveTo]) >= GETDATE()) ) AS [T] WHERE [RowNumber] > @PageIndex * @PageSize AND [RowNumber] <= (@PageIndex + 1) * @PageSize",
      "Remark": ""
    },
    {
      "key": "Data_QueryBulletinList_Web_Total",
      "Desc": "用户查询公告列表_总条数",
      "ParamDesc": "@BulletinAgent:bulletinAgent",
      "Director": "lili",
      "SQL": "SELECT @TotalCount = COUNT(1) FROM [E_SiteMessage_Bulletin_List] WHERE [Status] = 0 AND (BulletinAgent=@BulletinAgent) AND ([EffectiveFrom] IS NULL OR [EffectiveFrom] <= GETDATE()) AND ([EffectiveTo] IS NULL OR DATEADD(DAY,1,[EffectiveTo]) >= GETDATE())",
      "Remark": ""
    },
    {
      "key": "Data_QueryCurrentNewIssuseInfo",
      "Desc": "用户查询查询最新期号",
      "ParamDesc": "@GameCode:gameCode,@GameType:gameType",
      "Director": "lili",
      "SQL": "select i.* from C_Game_Issuse i inner join( select min(GameCode_IssuseNumber) as GameCode_IssuseNumber from C_Game_Issuse where GameCode=@GameCode and GameType=@GameType and Status=10 and OfficialStopTime > GETDATE() ) b on i.GameCode_IssuseNumber = b.GameCode_IssuseNumber",
      "Remark": ""
    }
  ]
}