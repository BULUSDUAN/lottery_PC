@using External.Core.Agnet;
@{
    var userRebate = ViewBag.SetNewUserRebate as OCAgentRebateInfoCollection;    
}
@section css{
    @UserHelper.css("mycenter.css")
    @UserHelper.css("commissio.css")
}
<div class="center mt10">
    <div class="new_buy_right">
        <div class="mycommenu">
            <a href="/commissio/myTc" >我的提成</a> <a href="/commissio/generalizeUser"
                class="up">推广用户</a> <a href="/commissio/CommissionRecord"
                   >返点结算</a> <a href="/commissio/StatisticsQuery" >
                        统计查询</a> <a href="/commissio/SchemeManage" >方案管理</a>
        </div>
        <div class="scheme">
            <div class="scheme-show">
                <a href="/commissio/generalizeUser">下级代理</a>
            </div>
            <div class="scheme-show">
                <a href="/commissio/subordinateuser" >下级用户</a>
            </div>
            <div class="scheme-show">
                <a href="/commissio/dealerMsg">添加代理</a>
            </div>
            <div class="scheme-show" style="width: 130px;">
                <a href="/commissio/setNewUserRebate">设置新用户返点</a>
            </div>
            <div class="scheme-show xzscheme" style="width: 130px;">
                <a href="javascript:void(0)" checklg="">配置用户返点</a>
            </div>
            <div class="scheme-show">
                <a href="/commissio/popularizeLink">推广链接</a>
            </div>
        </div>
        @{
            var jczq_brqspf = userRebate.FirstOrDefault(p => p.GameCode == "JCZQ" && p.GameType == "BRQSPF");
            var jczq_spf = userRebate.FirstOrDefault(p => p.GameCode == "JCZQ" && p.GameType == "SPF");
            var jczq_bf = userRebate.FirstOrDefault(p => p.GameCode == "JCZQ" && p.GameType == "BF");
            var jczq_zjq = userRebate.FirstOrDefault(p => p.GameCode == "JCZQ" && p.GameType == "ZJQ");
            var jczq_bqc = userRebate.FirstOrDefault(p => p.GameCode == "JCZQ" && p.GameType == "BQC");
            var jczq_hh = userRebate.FirstOrDefault(p => p.GameCode == "JCZQ" && p.GameType == "HH");
        }
        @{
            var bjdc_spf = userRebate.FirstOrDefault(p => p.GameCode == "BJDC" && p.GameType == "SPF");
            var bjdc_zjq = userRebate.FirstOrDefault(p => p.GameCode == "BJDC" && p.GameType == "ZJQ");
            var bjdc_sxds = userRebate.FirstOrDefault(p => p.GameCode == "BJDC" && p.GameType == "SXDS");
            var bjdc_bf = userRebate.FirstOrDefault(p => p.GameCode == "BJDC" && p.GameType == "BF");
            var bjdc_bqc = userRebate.FirstOrDefault(p => p.GameCode == "BJDC" && p.GameType == "BQC");
        }
        @{
            var cclq_sf = userRebate.FirstOrDefault(p => p.GameCode == "JCLQ" && p.GameType == "SF");
            var cclq_rfsf = userRebate.FirstOrDefault(p => p.GameCode == "JCLQ" && p.GameType == "RFSF");
            var cclq_sfc = userRebate.FirstOrDefault(p => p.GameCode == "JCLQ" && p.GameType == "SFC");
            var cclq_dxf = userRebate.FirstOrDefault(p => p.GameCode == "JCLQ" && p.GameType == "DXF");
            var cclq_hh = userRebate.FirstOrDefault(p => p.GameCode == "JCLQ" && p.GameType == "HH");                
        }
        @{
            var ctzq_t14c = userRebate.FirstOrDefault(p => p.GameCode == "CTZQ" && p.GameType == "T14C");
            var ctzq_tr9 = userRebate.FirstOrDefault(p => p.GameCode == "CTZQ" && p.GameType == "TR9");
            var ctzq_t6bqc = userRebate.FirstOrDefault(p => p.GameCode == "CTZQ" && p.GameType == "T6BQC");
            var ctzq_t4cjq = userRebate.FirstOrDefault(p => p.GameCode == "CTZQ" && p.GameType == "T4CJQ"); 
                               
        }
        @{
            var tycp_dlt = userRebate.FirstOrDefault(p => p.GameCode == "DLT" && p.GameType == "");
            var tycp_pl3 = userRebate.FirstOrDefault(p => p.GameCode == "PL3" && p.GameType == "");
        }
        @{
            var fc3d = userRebate.FirstOrDefault(p => p.GameCode == "FC3D" && p.GameType == "");
            var ssq = userRebate.FirstOrDefault(p => p.GameCode == "SSQ" && p.GameType == "");
        }
        @{               
            var gpc_cqssc = userRebate.FirstOrDefault(p => p.GameCode == "CQSSC" && p.GameType == "");
            var gpc_jx11x5 = userRebate.FirstOrDefault(p => p.GameCode == "JX11X5" && p.GameType == "");

            var gpc_sd11x5 = userRebate.FirstOrDefault(p => p.GameCode == "SD11X5" && p.GameType == "");
            var gpc_gd11x5 = userRebate.FirstOrDefault(p => p.GameCode == "GD11X5" && p.GameType == "");
            var gpc_gdklsf = userRebate.FirstOrDefault(p => p.GameCode == "GDKLSF" && p.GameType == "");
            var gpc_jsks = userRebate.FirstOrDefault(p => p.GameCode == "JSKS" && p.GameType == "");
            var gpc_sdklpk3 = userRebate.FirstOrDefault(p => p.GameCode == "SDKLPK3" && p.GameType == "");
        }
        @if (userRebate.FirstOrDefault() != null)
        {
            <table border="0" cellpadding="0" cellspacing="0" class="setUserRebate-table">
                <tr class="s-t-tr1">
                    <td width="210">
                        竞彩足球
                    </td>
                    <td class="unfoldorfold">
                        <a href="javascript:void(0)" class="toggleshow" onclick="toggle.bflick(this)">+展开</a>
                    </td>
                </tr>
                <tr style="border: 1px solid #d3d3d3; height: 39px; display: none;" class="show">
                    <td width="210" colspan="2">
                        让球胜平负：<input type="text" id="JCZQ:SPF" autocomplete="off" name="txtxt" value="@jczq_brqspf.Rebate.ToString("N2")" />
                        &nbsp;胜平负：<input type="text" id="JCZQ:BRQSPF" name="txtxt" value="@jczq_spf.Rebate.ToString("N2")" />
                        &nbsp;比分：<input type="text" id="JCZQ:BF" name="txtxt" value="@jczq_bf.Rebate.ToString("N2")" />
                        &nbsp;进球数：<input type="text" id="JCZQ:ZJQ"  name="txtxt" value="@jczq_zjq.Rebate.ToString("N2")" />
                        &nbsp;半全场：<input type="text" id="JCZQ:BQC" name="txtxt" value="@jczq_bqc.Rebate.ToString("N2")" />
                        &nbsp;混合过关：<input type="text" id="JCZQ:HH" name="txtxt" value="@jczq_hh.Rebate.ToString("N2")" />
                    </td>
                </tr>
                <tr class="s-t-tr1">
                    <td width="210">
                        北京单场
                    </td>
                    <td class="unfoldorfold">
                        <a href="javascript:void(0)" class="toggleshow" onclick="toggle.bflick(this)">+展开</a>
                    </td>
                </tr>
                <tr style="border: 1px solid #d3d3d3; height: 39px; display: none;" class="show">
                    <td width="210" colspan="2">
                        胜平负：<input type="text" id="BJDC:SPF" name="txtxt" value="@bjdc_spf.Rebate.ToString("N2")" />
                        &nbsp;进球数：<input type="text" id="BJDC:ZJQ"  name="txtxt" value="@bjdc_zjq.Rebate.ToString("N2")" />
                        &nbsp;上下单双：<input type="text" id="BJDC:SXDS" name="txtxt" value="@bjdc_sxds.Rebate.ToString("N2")" />
                        &nbsp;比分：<input type="text" id="BJDC:BF" name="txtxt" value="@bjdc_bf.Rebate.ToString("N2")" />
                        &nbsp;半全场：<input type="text" id="BJDC:BQC" name="txtxt" value="@bjdc_bqc.Rebate.ToString("N2")" />
                    </td>
                </tr>
                <tr class="s-t-tr1">
                    <td width="210">
                        竞彩篮球
                    </td>
                    <td class="unfoldorfold">
                        <a href="javascript:void(0)" class="toggleshow" onclick="toggle.bflick(this)">+展开</a>
                    </td>
                </tr>
                <tr style="border: 1px solid #d3d3d3; height: 39px; display: none;" class="show">
                    <td width="210" colspan="2">
                        胜负：<input type="text" id="JCLQ:SF" name="txtxt" value="@cclq_sf.Rebate.ToString("N2")" />
                        &nbsp;让分胜负：<input type="text" id="JCLQ:RFSF" name="txtxt" value="@cclq_rfsf.Rebate.ToString("N2")" />
                        &nbsp;胜负差：<input type="text" id="JCLQ:SFC" name="txtxt" value="@cclq_sfc.Rebate.ToString("N2")" />
                        &nbsp;大小分：<input type="text" id="JCLQ:DXF" name="txtxt" value="@cclq_dxf.Rebate.ToString("N2")" />
                        &nbsp;混合过关：<input type="text" id="JCLQ:HH" name="txtxt" value="@cclq_hh.Rebate.ToString("N2")" />
                    </td>
                </tr>
                <tr class="s-t-tr1">
                    <td width="210">
                        传统足球
                    </td>
                    <td class="unfoldorfold">
                        <a href="javascript:void(0)" class="toggleshow" onclick="toggle.bflick(this)">+展开</a>
                    </td>
                </tr>
                <tr style="border: 1px solid #d3d3d3; height: 39px; display: none;" class="show">
                    <td width="210" colspan="2">
                        14场胜负：<input type="text" id="CTZQ:T14C" name="txtxt" value="@ctzq_t14c.Rebate.ToString("N2")" />
                        &nbsp;胜负任9：<input type="text" id="CTZQ:TR9" name="txtxt" value="@ctzq_tr9.Rebate.ToString("N2")" />
                        &nbsp;6场半全：<input type="text" id="CTZQ:T6BQC" name="txtxt" value="@ctzq_t6bqc.Rebate.ToString("N2")" />
                        &nbsp;4场进球：<input type="text" id="CTZQ:T4CJQ"  name="txtxt" value="@ctzq_t4cjq.Rebate.ToString("N2")" />
                    </td>
                </tr>
                <tr class="s-t-tr1">
                    <td width="210">
                        体育彩票
                    </td>
                    <td class="unfoldorfold">
                        <a href="javascript:void(0)" class="toggleshow" onclick="toggle.bflick(this)">+展开</a>
                    </td>
                </tr>
                <tr style="border: 1px solid #d3d3d3; height: 39px; display: none;" class="show">
                    <td width="210" colspan="2">
                        大乐透：<input type="text" id="DLT:" name="txtxt" value="@tycp_dlt.Rebate.ToString("N2")" />
                        &nbsp;排列三：<input type="text" id="PL3:" name="txtxt" value="@tycp_pl3.Rebate.ToString("N2")" />
                    </td>
                </tr>
                <tr class="s-t-tr1">
                    <td width="210">
                        福彩3D
                    </td>
                    <td class="unfoldorfold">
                        <a href="javascript:void(0)" class="toggleshow" onclick="toggle.bflick(this)">+展开</a>
                    </td>
                </tr>
                <tr style="border: 1px solid #d3d3d3; height: 39px; display: none;" class="show">
                    <td width="210" colspan="2">
                        双色球：<input type="text" id="SSQ:" name="txtxt" value="@ssq.Rebate.ToString("N2")" />
                        &nbsp;福彩3D：<input type="text" id="FC3D:" name="txtxt" value="@fc3d.Rebate.ToString("N2")" />
                    </td>
                </tr>
                <tr class="s-t-tr1">
                    <td width="210">
                        高频彩
                    </td>
                    <td class="unfoldorfold">
                        <a href="javascript:void(0)" class="toggleshow" onclick="toggle.bflick(this)">-折叠</a>
                    </td>
                </tr>
                <tr style="border: 1px solid #d3d3d3; height: 39px;" class="show">
                    <td width="210" colspan="2">
                        重庆时时彩：<input type="text"  id="CQSSC:" name="txtxt" value="@gpc_cqssc.Rebate.ToString("N2")" />
                        &nbsp;江西11选5：<input type="text" id="JX11X5:" name="txtxt" value="@gpc_jx11x5.Rebate.ToString("N2")" />
                        &nbsp;山东11选5：<input type="text" id="SD11X5:" name="txtxt" value="@gpc_sd11x5.Rebate.ToString("N2")" />
                        &nbsp;广东11选5：<input type="text" id="GD11X5:" name="txtxt" value="@gpc_gd11x5.Rebate.ToString("N2")" />
                        &nbsp;广东快乐十分：<input type="text" id="GDKLSF:" name="txtxt" value="@gpc_gdklsf.Rebate.ToString("N2")" />
                        &nbsp;江苏快三：<input type="text" id="JSKS:" name="txtxt" value="@gpc_jsks.Rebate.ToString("N2")" />
                        &nbsp;山东快乐扑克3：<input type="text" id="SDKLPK3:" name="txtxt" value="@gpc_sdklpk3.Rebate.ToString("N2")" />
                    </td>
                </tr>
            </table>                 
        }
        else
        {
            <table border="0" cellpadding="0" cellspacing="0" class="setUserRebate-table">
                <tr class="s-t-tr1">
                    <td width="210">
                        竞彩足球
                    </td>
                    <td class="unfoldorfold">
                        <a href="javascript:void(0)" class="toggleshow" onclick="toggle.bflick(this)">+展开</a>
                    </td>
                </tr>
                <tr style="border: 1px solid #d3d3d3; height: 39px; display: none;" class="show">
                    <td width="210" colspan="2">
                        让球胜平负：<input type="text" id="JCZQ:SPF" autocomplete="off" name="txtxt" value="" />
                        &nbsp;胜平负：<input type="text" id="JCZQ:BRQSPF" name="txtxt" value="" />
                        &nbsp;比分：<input type="text" id="JCZQ:BF" name="txtxt" value="" />
                        &nbsp;进球数：<input type="text" id="JCZQ:ZJQ" name="txtxt" value="" />
                        &nbsp;半全场：<input type="text" id="JCZQ:BQC" name="txtxt" value="" />
                        &nbsp;混合过关：<input type="text" id="JCZQ:HH" name="txtxt" value="" />
                    </td>
                </tr>
                <tr class="s-t-tr1">
                    <td width="210">
                        北京单场
                    </td>
                    <td class="unfoldorfold">
                        <a href="javascript:void(0)" class="toggleshow" onclick="toggle.bflick(this)">+展开</a>
                    </td>
                </tr>
                <tr style="border: 1px solid #d3d3d3; height: 39px; display: none;" class="show">
                    <td width="210" colspan="2">
                        胜平负：<input type="text" id="BJDC:SPF" name="txtxt" value="" />
                        &nbsp;进球数：<input type="text" id="BJDC:ZJQ" name="txtxt" value="" />
                        &nbsp;上下单双：<input type="text" id="BJDC:SXDS" name="txtxt" value="" />
                        &nbsp;比分：<input type="text" id="BJDC:BF" name="txtxt" value="" />
                        &nbsp;半全场：<input type="text" id="BJDC:BQC" name="txtxt" value="" />
                    </td>
                </tr>
                <tr class="s-t-tr1">
                    <td width="210">
                        竞彩篮球
                    </td>
                    <td class="unfoldorfold">
                        <a href="javascript:void(0)" class="toggleshow" onclick="toggle.bflick(this)">+展开</a>
                    </td>
                </tr>
                <tr style="border: 1px solid #d3d3d3; height: 39px; display: none;" class="show">
                    <td width="210" colspan="2">
                        胜负：<input type="text" id="JCLQ:SF" name="txtxt" value="" />
                        &nbsp;让分胜负：<input type="text" id="JCLQ:RFSF" name="txtxt" value="" />
                        &nbsp;胜负差：<input type="text" id="JCLQ:SFC" name="txtxt" value="" />
                        &nbsp;大小分：<input type="text" id="JCLQ:DXF" name="txtxt" value="" />
                        &nbsp;混合过关：<input type="text" id="JCLQ:HH" name="txtxt" value="" />
                    </td>
                </tr>
                <tr class="s-t-tr1">
                    <td width="210">
                        传统足球
                    </td>
                    <td class="unfoldorfold">
                        <a href="javascript:void(0)" class="toggleshow" onclick="toggle.bflick(this)">+展开</a>
                    </td>
                </tr>
                <tr style="border: 1px solid #d3d3d3; height: 39px; display: none;" class="show">
                    <td width="210" colspan="2">
                        14场胜负：<input type="text" id="CTZQ:T14C" name="txtxt" value="" />
                        &nbsp;胜负任9：<input type="text" id="CTZQ:TR9" name="txtxt" value="" />
                        &nbsp;6场半全：<input type="text" id="CTZQ:T6BQC" name="txtxt" value="" />
                        &nbsp;4场进球：<input type="text" id="CTZQ:T4CJQ" name="txtxt" value="" />
                    </td>
                </tr>
                <tr class="s-t-tr1">
                    <td width="210">
                        体育彩票
                    </td>
                    <td class="unfoldorfold">
                        <a href="javascript:void(0)" class="toggleshow" onclick="toggle.bflick(this)">+展开</a>
                    </td>
                </tr>
                <tr style="border: 1px solid #d3d3d3; height: 39px; display: none;" class="show">
                    <td width="210" colspan="2">
                        大乐透：<input type="text" id="DLT:" name="txtxt" value="" />
                        &nbsp;排列三：<input type="text" id="PL3:" name="txtxt" value="" />
                    </td>
                </tr>
                <tr class="s-t-tr1">
                    <td width="210">
                        福彩3D
                    </td>
                    <td class="unfoldorfold">
                        <a href="javascript:void(0)" class="toggleshow" onclick="toggle.bflick(this)">+展开</a>
                    </td>
                </tr>
                <tr style="border: 1px solid #d3d3d3; height: 39px; display: none;" class="show">
                    <td width="210" colspan="2">
                        双色球：<input type="text" id="SSQ:" name="txtxt" value="" />
                        &nbsp;福彩3D：<input type="text" id="FC3D:" name="txtxt" value="" />
                    </td>
                </tr>
                <tr class="s-t-tr1">
                    <td width="210">
                        高频彩
                    </td>
                    <td class="unfoldorfold">
                        <a href="javascript:void(0)" class="toggleshow" onclick="toggle.bflick(this)">-折叠</a>
                    </td>
                </tr>
                <tr style="border: 1px solid #d3d3d3; height: 39px;" class="show">
                    <td width="210" colspan="2">
                        重庆时时彩：<input type="text" id="CQSSC:" name="txtxt" value="" />
                        &nbsp;江西11选5：<input type="text" id="JX11X5:" name="txtxt" value="" />
                        &nbsp;山东11选5：<input type="text" id="SD11X5:" name="txtxt" value="" />
                        &nbsp;广东11选5：<input type="text" id="GD11X5:" name="txtxt" value="" />
                        &nbsp;广东快乐十分：<input type="text" id="GDKLSF:" name="txtxt" value="" />
                        &nbsp;江苏快三：<input type="text" id="JSKS:" name="txtxt" value="" />
                        &nbsp;山东快乐扑克3：<input type="text" id="SDKLPK3:" name="txtxt" value="" />
                    </td>
                </tr>
            </table>      
        }
        <div class="dealer-save">
            <a href="javascript:void(0)" class="saveDealer">保&nbsp;&nbsp;&nbsp;&nbsp;存</a>
        </div>
        <input type="hidden" name="hdId" value="@ViewBag.Id" id="hdId" />
    </div>
</div>
<script type="text/javascript">
    var toggle = {
        bflick: function (obj) {
            var tr = $(obj).parents("tr").next(".show:first");
            if (tr.is(":visible")) {
                tr.hide();
                $(obj).text("+展开");

            } else {
                tr.show();
                $(obj).text("-折叠");
            }
        }
    }
    $(function () {
        $("input[name='txtxt']:text").attr("atomicselection", "false");
        var vs = $("input[name='txtxt']:text").val();
        if (vs == "") {
            $("input[name='txtxt']:text").val("0.00");
        }
        var error = 0;
        $("input:text").blur(function () {
            var val = $(this).attr("value");
            var reg = /^[0-9]+(\.[0-9]+)?$/;
            if (val == "") { $(this).attr("value", "0.00"); }
            if (val != "" && !reg.test(val)) {
                error++;
                alert('只能输入数字！');
                $(this).css("color", "red");
                return false;
            } else {
                if (val < 0) {
                    error++;
                    alert('设置的返点必须是大于或者等于0且小于100的小数');
                    $(this).css("color", "red");
                    return false;
                }
                else if (val > 100) {
                    error++;
                    alert('设置的返点必须是大于或者等于0且小于100的小数');
                    $(this).css("color", "red");
                    return false;
                }
                else {
                    error = 0;
                    $(this).css("color", "");
                }
            }
        });

        $(".saveDealer").click(function () {
            if (error != 0) {
                alert("设置的返点必须是大于或者等于0且小于100的小数");
                return false;
            }
            if (!confirm("是否保存?")) {
                return false;
            }
            var _this = $(this);
            //  _this.attr("disabled", "disabled");
            var dataArr = new Array();
            $("input[name='txtxt']:text").each(function () {
                var id = $(this).attr("id");
                var v = $(this).val();
                dataArr.push(id + ":" + v);
            })
            var dataStr = dataArr.join("|");
            var _id = $("#hdId").val();
            $.post("/commissio/savePZSNUR", { dataStr: dataStr, _id: _id }, function (data) {
                if (data.IsSuccess) {
                    alert(data.Msg);
                    location.href = location.href;
                }
                else {
                    alert(data.Message);
                    location.href = location.href;
                    //     _this.removeAttr("disabled");
                }
            })
        });
    });    
</script>
<div class="clearfix">
</div>
