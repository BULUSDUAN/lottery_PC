@using app.lottery.site.Models
@using External.Core.Agnet
@using GameBiz.Core
@{
    Layout = "../Shared/_LayoutFoud.cshtml";
    ViewBag.Title = "方案管理";
    ViewBag.keywords = "方案管理";
    var list = ViewBag.JuniorCreateTogether as SubUserNoPayRebateOrderInfoCollection;
    var user = ViewBag.CurrentUser as app.lottery.site.Models.CurrentUserInfo;
}
<div class="center mt10">
    @{Html.RenderPartial("Mycommenu", "Member");}
    @{Html.RenderPartial("toptipFoud", "Member");}
    <div class="new_buy_right">
        <div class="betorder_top">
            <ul>
                @if (user.LoginInfo.IsAgent)
                {
                    <li><a href="/member/generalizeUser">返点用户</a></li>
                    <li><a href="/member/CommissionRecord">返点结算</a></li>
                    <li><a href="/member/StatisticsQuery">统计查询</a></li>
                    <li class="betorder_topSelected"><a href="/member/SchemeManage">方案管理</a></li>
                }
            </ul>
        </div>
        <div class="betorder_con clearfix">
            <div class="scheme" style="border-bottom: 1px solid #d4eaff">
                <div class="scheme-show xzscheme" style="margin-left: 10px;">
                    <a href="/member/SchemeManage">发起中方案</a>
                </div>
                <div class="scheme-show">
                    <a href="/member/winScheme">已返返点方案</a>
                </div>
                <div class="scheme-show">
                    <a href="/member/PjScheme">未返返点方案</a>
                </div>
            </div>
            <div class="scheme-titile">
                <span class="dot"></span>
                <label class="lbfa">
                    发起中方案</label>
                <label class="lbtxt">
                    人数：<em style="color: #ff3c00; font-weight: bold; margin-right: 10px">@(list == null ? 0 : list.UserCount)</em>
                    订单数：<em style="color: #ff3c00; font-weight: bold; margin-right: 10px">@(list == null ? 0 : list.TotalCount)</em>
                    订单额：<em style="color: #ff3c00; font-weight: bold">@(list == null ? "0" : list.TotalMoney.ToString("N2"))</em>
                </label>
            </div>
            <div class="tab_box">
                <div style="width: 620px !important 540px; float: left; height: 40px; line-height: 40px;">
                    &nbsp;&nbsp;&nbsp;&nbsp;用户名：<input type="text" name="txtKey" class="orderId" value="@(ViewBag.Key == null ? string.Empty : ViewBag.Key)"  id="txtKey" />
                    &nbsp;&nbsp;日期：@ViewHelpers.Calendar3("begin", ViewBag.Begin)至 @ViewHelpers.Calendar3("end", ViewBag.End)
                    &nbsp;&nbsp;<input class="search_btn" type="button" onclick="getJuniorCreateTogether(0,10)"
                        value="查询" />
                </div>
                <table border="0" cellpadding="0" cellspacing="0" class="betorder_table">
                    <tr class="tr_head">
                        @*<th width="130">
                            详细
                        </th>*@
                        <th width="135">
                            时间
                        </th>
                        <th width="145">
                            用户
                        </th>
                        <th width="136">
                            彩种
                        </th>
                        <th width="131">
                            进度
                        </th>
                        <th width="131">
                            方案金额
                        </th>
                    </tr>
                    @if (list != null && list.List.Count > 0)
                    {
                        foreach (var item in list.List)
                        {
                        <tr>
                            @*<td class="orderId">
                                    <a href="javascript:void(0)" checklg="/user/scheme/@item.SchemeId">详细</a>
                                </td>*@
                            <td>
                                @(item.CreateTime.ToString() == "0001/1/1 0:00:00" ? "" : item.CreateTime.ToString("yyyy-MM-dd HH:mm:ss"))
                            </td>
                            <td class="orderId">
                                @SiteString.HideUserName(item.DisplayName, item.HideDisplayNameCount)
                            </td>
                            <td>
                                @SiteConvert.GameName(item.GameCode)
                            </td>
                            <td class="jd">
                                @if (item.TicketStatus == TicketStatus.Waitting)
                                {
                                    @Html.Raw("待开始")
                                }
                                else if (item.TicketStatus == TicketStatus.Ticketing)
                                {
                                    @Html.Raw("投注中")
                                }
                                else if (item.TicketStatus == TicketStatus.PrintTicket)
                                {
                                    @Html.Raw("已打票")
                                }
                                else
                                {
                                    @Html.Raw("未知")
                                }
                            </td>
                            <td class="ye">
                                @item.TotalMonery.ToString("N2")
                            </td>
                        </tr>
                        }
                    }
                    else
                    {
                        <tr>
                            <td colspan="6">
                                暂时没有找到你要的数据哦
                            </td>
                        </tr>
                    }
                </table>
                <p class="tip" style="margin-top: 10px;">
                    注意：发起中方案最多可查询一个月数据</p>
                <div style="margin-top: -15px;">
                    @ViewHelpers.Pager6("getJuniorCreateTogether", ViewBag.pageNo, 10, list == null ? 0 : list.TotalCount)
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    $(function () {
        $(".scheme-table tr:odd:gt(0)").css("backgroundColor", "#f9f9f9");
    });

    function getJuniorCreateTogether(pageNo, pageSize) {
        var begin = $("#begin").val();
        var end = $("#end").val();
        var key = $("#txtKey").val();
        var search = "pageNo=" + pageNo + "&pageSize=" + pageSize + "&begin=" + begin + "&end=" + end + "&r=" + Math.random().toFixed(5);
        if (key != null) {
            search = search + "&key=" + key;
        }
        location.search = search;
    }   
</script>
<div class="clearfix">
</div>
