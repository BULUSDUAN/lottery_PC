@using GameBiz.Core;
@using app.lottery.site.Models;
@{
    ViewBag.Title = "所有名家";
    Layout = "../Shared/_Expert.cshtml";
    var AllExpert = ViewBag.AllExpert as ExperterInfoCollection;
    var tucao = ViewBag.Tucao as ExperterCommentsCollection;
    var expertWeek = ViewBag.ExpertWeek as ExperterShootingInfoCollection;
    var expertMonth = ViewBag.ExpertMonth as ExperterShootingInfoCollection;
    var expertTotal = ViewBag.ExpertTotal as ExperterShootingInfoCollection;

    var j = 0; var k = 0; var m = 0; var n = 0;
}
<script type="text/javascript">
    function showCount() {
        var strChar = document.getElementById('txtArea').value;

        var charCount = strChar.length;
        if (charCount <= 60)
            document.getElementById('test2').value = 60 - Number(charCount);
        else {
            alert('最多输入60个字!');
            document.getElementById('txtArea').value = strChar.substring(0, 60);
        }
    }
</script>
<div id="body">
    <div id="log">
        <div class="left">
            <div class="l_wire">
            </div>
            <div class="l_img">
            </div>
        </div>
        <div class="right">
            <a href="javascript:void(0)" class="r_a" id="NewV">@ViewBag.Time</a>
            <div class="hdSelect">
                @for (int i = 0; i < 10; i++)
                {
                    var str = DateTime.Today.AddDays(-i).ToString("yyyy-MM-dd");
                    <a class="r_a" txt="@str">@str</a>
                }
            </div>
        </div>
        <div style="clear: both;">
        </div>
    </div>
    <div id="content">
        <div class="middle" style="margin-top: 50px;">
            <div class="left" style="margin-left: 7px;">
                <div class="cul_title">
                    推荐名家专栏<span class="en">Recommended famous column</span><a href="Index" class="backbtn">返回频道</a></div>
                <div class="col_box">
                    @if (AllExpert != null && AllExpert.TotalCount > 0)
                    {
                        foreach (var item in AllExpert.List)
                        {
                            if (j % 4 == 0)
                            {
                        <div class="col_left">
                            <div class="col_red1 col_font">
                                <a href="/Expert/PersonSpacial?UserID=@item.UserId" target="_blank" class="col_ts" style="margin-left: 35px; color:White;" title="@item.DisplayName">@(item.DisplayName.Length > 10 ? item.DisplayName.Substring(0, 10) + "…" : item.DisplayName)</a>
                                @{
                                var gamecode = "";
                                var game = item.AdeptGameCode;
                                switch (game)
                                {
                                    case "JCZQ":
                                        gamecode = "竞彩足球";
                                        break;
                                    case "JCZQ/JCLQ":
                                        gamecode = "竞彩足球/竞彩篮球";
                                        break;
                                    case "JCZQ/BJDC":
                                        gamecode = "竞彩足球/北京单场";
                                        break;
                                    case "JCZQ/CTZQ":
                                        gamecode = "竞彩足球/传统足球";
                                        break;
                                    default:
                                        gamecode = item.AdeptGameCode;
                                        break;
                                }
                                }
                                <span class="col_span">@gamecode</span>
                            </div>
                            <div class="col_t" style="float: right;">
                                <div class="user_img" style="float: left; border: none;">
                                    @if (!string.IsNullOrEmpty(item.ExperterHeadImage))
                                    {
                                        <a href="/Expert/PersonSpacial?UserID=@item.UserId" target="_blank">
                                            <img src="@item.ExperterHeadImage" alt="" width="50" height="65" /></a>
                                    }
                                    else
                                    {
                                        <a href="/Expert/PersonSpacial?UserID=@item.UserId" target="_blank">
                                            <img src="@ViewHelpers.img("../images/expert/default_header.jpg")" alt="" width="50" height="65" /></a>
                                    }
                                </div>
                                <div class="user_txt" style="float: right;">
                                    <p>
                                        @(item.ExperterSummary.Length > 35 ? item.ExperterSummary.Substring(0, 35) + "..." : item.ExperterSummary)</p>
                                    <a href="/Expert/PersonSpacial?UserID=@item.UserId" target="_blank" class="btn" style="float: right;">
                                        了解详情</a>
                                </div>
                            </div>
                        </div>
                            }
                            else if (j % 4 == 1)
                            {
                        <div class="col_right">
                            <div class="col_red2 col_font">
                                <a href="/Expert/PersonSpacial?UserID=@item.UserId" target="_blank" class="col_ts" style="color:White;" title="@item.DisplayName">@(item.DisplayName.Length > 10 ? item.DisplayName.Substring(0, 10) + "…" : item.DisplayName)</a>
                                @{
                                var gamecode = "";
                                var game = item.AdeptGameCode;
                                switch (game)
                                {
                                    case "JCZQ":
                                        gamecode = "竞彩足球";
                                        break;
                                    case "JCZQ/JCLQ":
                                        gamecode = "竞彩足球/竞彩篮球";
                                        break;
                                    case "JCZQ/BJDC":
                                        gamecode = "竞彩足球/北京单场";
                                        break;
                                    case "JCZQ/CTZQ":
                                        gamecode = "竞彩足球/传统足球";
                                        break;
                                    default:
                                        gamecode = item.AdeptGameCode;
                                        break;
                                }
                                }
                                <span class="col_span" style="margin-right: 30px;">@gamecode</span></div>
                            <div class="col_t">
                                <div class="user_txt" style="float: left;">
                                    <p>
                                        @(item.ExperterSummary.Length > 35 ? item.ExperterSummary.Substring(0, 35) + "..." : item.ExperterSummary)</p>
                                    <a href="/Expert/PersonSpacial?UserID=@item.UserId" target="_blank" class="btn" style="float: left;">
                                        了解详情</a>
                                </div>
                                <div class="user_img" style="float: right; border: none;">
                                    @if (!string.IsNullOrEmpty(item.ExperterHeadImage))
                                    {
                                        <a href="/Expert/PersonSpacial?UserID=@item.UserId" target="_blank">
                                            <img src="@item.ExperterHeadImage" alt="" width="50" height="65" /></a>
                                    }
                                    else
                                    {
                                        <a href="/Expert/PersonSpacial?UserID=@item.UserId" target="_blank">
                                            <img src="@ViewHelpers.img("../images/expert/default_header.jpg")" alt="" width="50" height="65" /></a>
                                    }
                                </div>
                            </div>
                        </div>
                            }
                            else if (j % 4 == 2)
                            {
                        <div class="col_left">
                            <div class="colbg_yellow1 col_font">
                                <a href="/Expert/PersonSpacial?UserID=@item.UserId" target="_blank" class="col_ts" style="margin-left: 35px; color:Black;" title="@item.DisplayName">@(item.DisplayName.Length > 10 ? item.DisplayName.Substring(0, 10) + "…" : item.DisplayName)</a>
                                @{
                                var gamecode = "";
                                var game = item.AdeptGameCode;
                                switch (game)
                                {
                                    case "JCZQ":
                                        gamecode = "竞彩足球";
                                        break;
                                    case "JCZQ/JCLQ":
                                        gamecode = "竞彩足球/竞彩篮球";
                                        break;
                                    case "JCZQ/BJDC":
                                        gamecode = "竞彩足球/北京单场";
                                        break;
                                    case "JCZQ/CTZQ":
                                        gamecode = "竞彩足球/传统足球";
                                        break;
                                    default:
                                        gamecode = item.AdeptGameCode;
                                        break;
                                }
                                }
                                <span class="col_span">@gamecode</span>
                            </div>
                            <div class="col_t" style="float: right;">
                                <div class="user_img" style="float: left; border: none;">
                                    @if (!string.IsNullOrEmpty(item.ExperterHeadImage))
                                    {
                                        <a href="/Expert/PersonSpacial?UserID=@item.UserId" target="_blank">
                                            <img src="@item.ExperterHeadImage" alt="" width="50" height="65" /></a>
                                    }
                                    else
                                    {
                                        <a href="/Expert/PersonSpacial?UserID=@item.UserId" target="_blank">
                                            <img src="@ViewHelpers.img("../images/expert/default_header.jpg")" alt="" width="50" height="65" /></a>
                                    }
                                </div>
                                <div class="user_txt" style="float: right;">
                                    <p>
                                        @(item.ExperterSummary.Length > 35 ? item.ExperterSummary.Substring(0, 35) + "..." : item.ExperterSummary)</p>
                                    <a href="/Expert/PersonSpacial?UserID=@item.UserId" target="_blank" class="btn" style="float: right;">
                                        了解详情</a>
                                </div>
                            </div>
                        </div>
                            }
                            else if (j % 4 == 3)
                            {
                        <div class="col_right">
                            <div class="colbg_yellow2 col_font">
                                <a href="/Expert/PersonSpacial?UserID=@item.UserId" target="_blank" style="color:Black;" class="col_ts" title="@item.DisplayName">@(item.DisplayName.Length > 10 ? item.DisplayName.Substring(0, 10) + "…" : item.DisplayName)</a>
                                @{
                                var gamecode = "";
                                var game = item.AdeptGameCode;
                                switch (game)
                                {
                                    case "JCZQ":
                                        gamecode = "竞彩足球";
                                        break;
                                    case "JCZQ/JCLQ":
                                        gamecode = "竞彩足球/竞彩篮球";
                                        break;
                                    case "JCZQ/BJDC":
                                        gamecode = "竞彩足球/北京单场";
                                        break;
                                    case "JCZQ/CTZQ":
                                        gamecode = "竞彩足球/传统足球";
                                        break;
                                    default:
                                        gamecode = item.AdeptGameCode;
                                        break;
                                }
                                }
                                <span class="col_span" style="margin-right: 30px;">@gamecode</span></div>
                            <div class="col_t">
                                <div class="user_txt" style="float: left;">
                                    <p>
                                        @(item.ExperterSummary.Length > 35 ? item.ExperterSummary.Substring(0, 35) + "..." : item.ExperterSummary)</p>
                                    <a href="/Expert/PersonSpacial?UserID=@item.UserId" target="_blank" class="btn" style="float: left;">
                                        了解详情</a>
                                </div>
                                <div class="user_img" style="float: right; border: none;">
                                    @if (!string.IsNullOrEmpty(item.ExperterHeadImage))
                                    {
                                        <a href="/Expert/PersonSpacial?UserID=@item.UserId" target="_blank">
                                            <img src="@item.ExperterHeadImage" alt="" width="50" height="65" /></a>
                                    }
                                    else
                                    {
                                        <a href="/Expert/PersonSpacial?UserID=@item.UserId" target="_blank">
                                            <img src="@ViewHelpers.img("../images/expert/default_header.jpg")" alt="" width="50" height="65" /></a>
                                    }
                                </div>
                            </div>
                        </div>
                            }
                            j++;
                        }
                    }
                </div>
            </div>
            <div class="right">
                <div class="ml_box">
                    <div class="title">
                        拍砖吐槽</div>
                    <div class="ml_textarea shadow" style="overflow: auto;">
                        <ul>
                            @foreach (var tu in tucao.List)
                            {
                                if (tu.Content != null)
                                {
                                <li style="width: 100%;">
                                    <input type="hidden" id="TuId" value="@tu.Id" />
                                    <div class="tucao">
                                        <span class="tu_p" title="@tu.DisplayName">@(tu.DisplayName.Length > 8 ? tu.DisplayName.Substring(0, 8) + "..." : tu.DisplayName)</span>
                                        <span class="tu_s">
                                            @{
                                    var time = tu.CreateTime;
                                    var timeNow = DateTime.Now;
                                    TimeSpan str = timeNow - time;
                                    var days = str.Days;
                                    var hours = str.Hours;
                                    var minute = str.Minutes;
                                    var second = str.Seconds;
                                    var createtime = "";
                                    if (days == 0 && hours == 0 && minute == 0 && second < 60)
                                    {
                                        createtime = "刚刚";
                                    }
                                    else if (days == 0 && hours == 0 && minute < 60)
                                    {
                                        createtime = minute + "分钟前";
                                    }
                                    else if (days == 0 && hours < 60)
                                    {
                                        createtime = hours + "小时前";
                                    }
                                    else if (days < 24)
                                    {
                                        createtime = days + "天前";
                                    }
                                    else if ((days / 24) > 0)
                                    {
                                        createtime = (days / 24) + "月前";
                                    }
                                    else if ((days / 24 / 12) > 0)
                                    {
                                        createtime = (days / 24 / 12) + "年前";
                                    }
                                            }
                                            @createtime</span>
                                        <div style="clear: both;">
                                        </div>
                                        <div class="chatinfo">
                                            <span class="tu_span"></span>
                                            <div>@tu.Content</div>
                                        </div>
                                    </div>
                                </li>
                                }
                            }
                        </ul>
                    </div>
                    <div class="ml_s">
                        <span class="span3">我有话说</span><span class="span4">评论改变个人观点</span>
                    </div>
                    <div>
                        <textarea class="textarea" name="txtArea" id="txtArea" onkeyup="showCount();"></textarea>
                    </div>
                    <div class="comment">
                        <div class="p">
                            <p class="p1">
                                还可以输入<input name="test2" id="test2" value="60" />个字</p>
                            <p style="font-size: 10px; color: Red;">
                                只限本站用户发表评论</p>
                        </div>
                        <a href="javascript:void(0);" class="combtn" id="Comment">评论</a>
                    </div>
                </div>
                <div class="remlog">
                    <a href="Recommend" target="_blank">
                        <img src="@ViewHelpers.img("../images/expert/remlog.png")" alt="" /></a></div>
                <div class="remmaster">
                    <div class="mas_title">
                        <span>推荐名家命中榜</span>
                        <div class="mas_d">
                            <span class="zhou redd">周</span><span class="yue">月</span><span class="zong">总</span></div>
                    </div>
                    <div class="mas_box shadow" style="display: block;" id="zhou">
                        <ul>
                            @foreach (var exper in expertWeek.List)
                            {
                                if (n % 2 == 0)
                                {
                                <li class="mas_d1"><a href="/Expert/PersonSpacial?UserID=@exper.UserId" title="@exper.DisplayName">@(exper.DisplayName.Length > 8 ? exper.DisplayName.Substring(0, 8) + "…" : exper.DisplayName)</a><span
                                    class="span">
                                    @{
                                    var shoot = (Decimal.Parse(exper.Shooting.ToString("N2")) * 100);
                                    
                                    }
                                    @shoot.ToString("N0")% </span></li>
                                }
                                else
                                {
                                <li class="mas_d2"><a href="/Expert/PersonSpacial?UserID=@exper.UserId" title="@exper.DisplayName">@(exper.DisplayName.Length > 8 ? exper.DisplayName.Substring(0, 8) + "…" : exper.DisplayName)</a><span
                                    class="span">
                                    @{
                                    var shoot = (Decimal.Parse(exper.Shooting.ToString("N2")) * 100);
                                    
                                    }
                                    @shoot.ToString("N0")% </span></li>
                                }
                                n++;
                            }
                        </ul>
                    </div>
                    <div class="mas_box shadow" style="display: none;" id="yue">
                        <ul>
                            @foreach (var exper in expertMonth.List)
                            {
                                if (k % 2 == 0)
                                {
                                <li class="mas_d2"><a href="/Expert/PersonSpacial?UserID=@exper.UserId" title="@exper.DisplayName">@(exper.DisplayName.Length > 8 ? exper.DisplayName.Substring(0, 8) + "…" : exper.DisplayName)</a><span
                                    class="span">
                                    @{
                                    var shoot = (Decimal.Parse(exper.Shooting.ToString("N2")) * 100);
                                    
                                    }
                                    @shoot.ToString("N0")% </span></li>
                                }
                                else
                                {
                                <li class="mas_d1"><a href="/Expert/PersonSpacial?UserID=@exper.UserId" title="@exper.DisplayName">@(exper.DisplayName.Length > 8 ? exper.DisplayName.Substring(0, 8) + "…" : exper.DisplayName)</a><span
                                    class="span">
                                    @{
                                    var shoot = (Decimal.Parse(exper.Shooting.ToString("N2")) * 100);
                                    
                                    }
                                    @shoot.ToString("N0")% </span></li>
                                }
                                k++;
                            }
                        </ul>
                    </div>
                    <div class="mas_box shadow" style="display: none;" id="zong">
                        <ul>
                            @foreach (var exper in expertTotal.List)
                            {
                                if (m % 2 == 0)
                                {
                                <li class="mas_d1"><a href="/Expert/PersonSpacial?UserID=@exper.UserId" title="@exper.DisplayName">@(exper.DisplayName.Length > 8 ? exper.DisplayName.Substring(0, 8) + "…" : exper.DisplayName)</a><span
                                    class="span">
                                    @{
                                    var shoot = (Decimal.Parse(exper.Shooting.ToString("N2")) * 100);
                                    
                                    }
                                    @shoot.ToString("N0")% </span></li>
                                }
                                else
                                {
                                <li class="mas_d2"><a href="/Expert/PersonSpacial?UserID=@exper.UserId" title="@exper.DisplayName">@(exper.DisplayName.Length > 8 ? exper.DisplayName.Substring(0, 8) + "…" : exper.DisplayName)</a><span
                                    class="span">
                                    @{
                                    var shoot = (Decimal.Parse(exper.Shooting.ToString("N2")) * 100);
                                    
                                    }
                                    @shoot.ToString("N0")% </span></li>
                                }
                                m++;
                            }
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div style="clear: both;">
        </div>
        @{Html.RenderAction("Footer", "Expert");}
    </div>
</div>
<script type="text/javascript">
    //周的点击事件，隐藏 总 月
    $(".zhou").click(function () {
        $("#yue").hide();
        $("#zong").hide();
        $("#zhou").show();
        $(this).css("color", "red")
        $(this).siblings().css("color", "black")
    });
    $(".yue").click(function () {
        $("#zhou").hide();
        $("#zong").hide();
        $("#yue").show();
        $(this).css("color", "red")
        $(this).siblings().css("color", "black")
    });
    $(".zong").click(function () {
        $("#yue").hide();
        $("#zhou").hide();
        $("#zong").show();
        $(this).css("color", "red")
        $(this).siblings().css("color", "black")
    });

    $(".r_a").click(function () {

        if ($(".hdSelect").is(":visible")) {
            $(".hdSelect").css("display", "none");
            var time = $(this).text();
            $("#NewV").text(time);
            location.href = "/Expert/AllExpert?time=" + time;
        }
        else {
            $(".hdSelect").css("display", "block");
        }
    });
    $(document).bind('click', function (e) {
        var e = e || window.event; //浏览器兼容性
        var elem = e.target || e.srcElement;
        while (elem) { //循环判断至跟节点，防止点击的是div子元素
            if (elem.id && elem.id == 'NewV') {
                return;
            }
            elem = elem.parentNode;
        }
        $('.hdSelect').css('display', 'none'); //点击的不是div或其子元素
    });
    $("#Comment").click(function () {
        user.isLogin(function (islogin) {
            if (!islogin) {
                loginDialog.Show();
                $("#userName").focus();
            } else {
                var Content = $("#txtArea").val();
                var userid = $("").val();
                if (Content == "") {
                    alert("内容不能为空！");
                    return false;
                }
                var commentstpye = "30";
                $.post("/Expert/AddTucao", { Content: Content, CommentsTpye: commentstpye }, function (Json) {
                    if (Json.IsSucess == false) {
                        alert(Json.Msg);
                        return false;
                    }
                    else {
                        alert(Json.Msg);
                        $("#txtArea").val("");
                    }
                });
            }
        });
    });

</script>
