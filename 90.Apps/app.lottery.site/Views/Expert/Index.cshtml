@using GameBiz.Core;
@using app.lottery.site.Models;
@using app.lottery.site.Controllers;
@{
    ViewBag.Title = "名家首页";
    Layout = "../Shared/_Expert.cshtml";
    var Comment = ViewBag.Comment as ExperterSchemeInfoCollection;
    var ExperterList = ViewBag.ExperterList as ExperterInfoCollection;
    var tucao = ViewBag.Tucao as ExperterCommentsCollection;
    var expertWeek = ViewBag.ExpertWeek as ExperterShootingInfoCollection;
    var expertMonth = ViewBag.ExpertMonth as ExperterShootingInfoCollection;
    var expertTotal = ViewBag.ExpertTotal as ExperterShootingInfoCollection;
    var user = ViewBag.User as ExperterInfo;
    var oddstype = string.IsNullOrEmpty(Request["oddstype"]) ? 2 : int.Parse(Request["oddstype"]);
    var i = 0; var j = 0; var a = 1; var b = 0; var w = 0; var t = 0;
}
<script type="text/javascript">
    function showCount() {
        var strChar = document.getElementById('txtArea').value;

        var charCount = strChar.length;
        if (charCount <= 60)
            document.getElementById('test2').value = 60 - Number(charCount);
        else {
            alert('最多输入60个字!');
            document.getElementById('txtArea').value = strChar.substring(0, 60);
        }
    }
</script>
<div id="bodyIndex">
    <div id="log">
        <div class="left">
            <div class="l_wire">
            </div>
            <div class="l_img">
            </div>
        </div>
        <div class="right">
            <a href="javascript:void(0)" class="r_a" id="NewV">@ViewBag.Time</a>
            <div class="hdSelect">
                @for (int k = 0; k < 10; k++)
                {
                    var str = DateTime.Today.AddDays(-k).ToString("yyyy-MM-dd");
                    <a class="r_a" txt="@str">@str</a>
                }
            </div>
        </div>
        <div style="clear: both;">
        </div>
    </div>
    <div id="content">
        <div class="top">
            <p>
                我们为大家推荐的方案是根据大量的数据统计及经过足球名家团的经验总结得出的，我们努力提高命中率，</p>
            <p>
                希望能为彩民更好的服务</p>
        </div>
        <div style="clear: both;">
        </div>
        <div class="middle">
            <div class="left">
                <div class="program">
                    <ul>
                        @if (Comment.TotalCount != 0)
                        {
                            foreach (var item in Comment.List)
                            {
                                Sports_AnteCodeQueryInfoCollection indent = WCFClients.GameClient.QuerySportsOrderAnteCodeList(item.SchemeId, ViewBag.UserToken);
                                ExperterInfo name = WCFClients.ExperterClient.QueryExperterById(item.UserId);
                            <li>
                                <div class="pro_title">
                                    推荐方案<span class="icon_pro">@a</span><a class="tui_name" href="/Expert/PersonSpacial?UserID=@item.UserId" target="_blank">
                                        @{
                                byte[] myByte = System.Text.Encoding.Default.GetBytes(name.DisplayName);
                                var disname = "";
                                if (myByte.Length >= 10 && name.DisplayName.Length > 5 && name.DisplayName.Length <= 10)
                                {
                                    disname = name.DisplayName.Substring(0, 5) + "..";
                                }
                                else if (name.DisplayName.Length > 10)
                                {
                                    disname = name.DisplayName.Substring(0, 10) + "..";
                                }
                                else
                                {
                                    disname = name.DisplayName;
                                }
                                        }
                                        @disname</a></div>
                                <div class="box">
                                    @foreach (var inden in indent.Take(2).ToList())
                                    {
                                        <div class="pro_d1 top10">
                                            @{
                                        //140907 003
                                        var match = inden.MatchId.Split(',');
                                        var weeklist = new List<string>();
                                        var week = "";
                                        var num = "";
                                        if (match.Length > 0)
                                        {
                                            foreach (var str in match)
                                            {
                                                var MatchId = "20" + str.Substring(0, 6);
                                                var time = DateTime.Parse(MatchId.Substring(0, 4) + "-" + MatchId.Substring(4, 2) + "-" + MatchId.Substring(6, 2)).DayOfWeek;
                                                switch (time)
                                                {
                                                    case DayOfWeek.Friday:
                                                        week = "周五";
                                                        break;
                                                    case DayOfWeek.Monday:
                                                        week = "周一";
                                                        break;
                                                    case DayOfWeek.Saturday:
                                                        week = "周六";
                                                        break;
                                                    case DayOfWeek.Sunday:
                                                        week = "周日";
                                                        break;
                                                    case DayOfWeek.Thursday:
                                                        week = "周四";
                                                        break;
                                                    case DayOfWeek.Tuesday:
                                                        week = "周二";
                                                        break;
                                                    case DayOfWeek.Wednesday:
                                                        week = "周三";
                                                        break;
                                                }
                                                num = str.Substring(6, 3);
                                                var list = week + num;
                                                weeklist.Add(list);
                                            }
                                        }
                                        else
                                        {
                                            var MatchId = "20" + inden.MatchId.Substring(0, 6);
                                            var time = DateTime.Parse(MatchId.Substring(0, 4) + "-" + MatchId.Substring(4, 2) + "-" + MatchId.Substring(6, 2)).DayOfWeek;
                                            switch (time)
                                            {
                                                case DayOfWeek.Friday:
                                                    week = "周五";
                                                    break;
                                                case DayOfWeek.Monday:
                                                    week = "周一";
                                                    break;
                                                case DayOfWeek.Saturday:
                                                    week = "周六";
                                                    break;
                                                case DayOfWeek.Sunday:
                                                    week = "周日";
                                                    break;
                                                case DayOfWeek.Thursday:
                                                    week = "周四";
                                                    break;
                                                case DayOfWeek.Tuesday:
                                                    week = "周二";
                                                    break;
                                                case DayOfWeek.Wednesday:
                                                    week = "周三";
                                                    break;
                                            }
                                            num = inden.MatchId.Substring(6, 3);
                                            var list = week + num;
                                            weeklist.Add(list);
                                        }
                                            }
                                            <span class="tj_time">@Html.Raw(string.Join(",", weeklist.ToArray()))</span><span
                                                class="jiantou_w"></span><span class="letball">
                                                    @if (inden.GameType == "SPF")
                                                    {
                                                        @inden.LetBall
                                                    }</span><span class="bsdf_a">
                                                        @{
                                                    var hometeamname = "";
                                                    byte[] myBytehome = System.Text.Encoding.Default.GetBytes(inden.HomeTeamName);
                                                    if (myBytehome.Length > 10 && inden.HomeTeamName.Length < 10)
                                                    {
                                                        hometeamname = inden.HomeTeamName.Substring(0, 5);
                                                    }
                                                    else { hometeamname = inden.HomeTeamName; }
                                                        }
                                                        @hometeamname
                                                    </span><span class="vs">VS</span><span class="bsdf_b">
                                                        @{
                                                    var guestteamname = "";
                                                    byte[] myByteguest = System.Text.Encoding.Default.GetBytes(inden.GuestTeamName);
                                                    if (myByteguest.Length > 10 && inden.GuestTeamName.Length < 10)
                                                    {
                                                        guestteamname = inden.GuestTeamName.Substring(0, 5);
                                                    }
                                                    else { guestteamname = inden.GuestTeamName; }
                                                        }
                                                        @guestteamname</span>
                                        </div>
                                        <div class="pro_d2 top10">
                                            @{
                                                    var codeArray = inden.AnteCode.Split(',');
                                                    var codeNameList = new List<string>();
                                                    foreach (var code in codeArray)
                                                    {
                                                        var tempName = string.Empty;
                                                        switch (code)
                                                        {
                                                            case "3":
                                                                tempName = "胜";
                                                                break;
                                                            case "1":
                                                                tempName = "平";
                                                                break;
                                                            case "0":
                                                                tempName = "负";
                                                                break;
                                                        }
                                                        if (inden.GameType == "SPF")
                                                        { tempName = "让" + tempName; }
                                                        codeNameList.Add(tempName);
                                                    }
                                            }
                                            <span class="tuijian">推&nbsp;&nbsp;&nbsp;&nbsp;荐：</span><span class="jiantou_b"></span>
                                            <span style="color: Red; margin-left: 60px; margin-right: 20px;">@Html.Raw(string.Join("&nbsp;&nbsp;", codeNameList.ToArray()))</span></div>
                                        <div class="div pro_bg top10">
                                            <span class="tzbl">投注赔率：</span>
                                            @foreach (var c in new string[] { "3", "1", "0" })
                                            {
                                                var cName = string.Empty;
                                                switch (c)
                                                {
                                                    case "3":
                                                        cName = "胜";
                                                        break;
                                                    case "1":
                                                        cName = "平";
                                                        break;
                                                    case "0":
                                                        cName = "负";
                                                        break;
                                                }
                                                if (inden.GameType == "SPF")
                                                { cName = "让" + cName; }
                                                //3|2.70,1|3.40,0|2.16,-1|1
                                                var spArray = inden.CurrentSp.Split(',');
                                                var realSp = 0M;
                                                foreach (var sp in spArray)
                                                {
                                                    //3|2.70
                                                    var sArray = sp.Split('|');
                                                    if (sArray.Length != 2) { continue; }
                                                    if (sArray[0] == c)
                                                    {
                                                        realSp = decimal.Parse(sArray[1]);
                                                        break;
                                                    }
                                                }

                                                var html = string.Empty;
                                                if (codeNameList.Contains(cName))
                                                {
                                                    //选中
                                                    html += string.Format("<span data=\"{0}\" class=\"tz tjtz\" value=\"{1}\">{2} {3}</span>"
                                                        , string.Format("{0}-{1}", c, realSp), realSp, cName, realSp);
                                                }
                                                else
                                                {
                                                    html += string.Format("<span class=\"tz\">{0} {1}</span>", cName, realSp);
                                                }
                                                @Html.Raw(html);
                                            }
                                            <span class="fenxi">析</span>
                                            <input type="hidden" value="@inden.MatchId" name="matchid" />
                                            <input type="hidden" value="@(week + num)" name="week" />
                                            <input type="hidden" value="@inden.HomeTeamName" name="host"/>
                                            <input type="hidden" value="@inden.GuestTeamName" name="visit"/>
                                            <input type="hidden" value="@inden.LetBall" name="lose"/>
                                            <input type="hidden" value="@item.StopTime" name="stoptime"/>
                                            <input type="hidden" value="@inden.GameType" name="play"/>
                                        </div>
                                    }
                                    <div class="pro_com">
                                        方案支持</div>
                                    <div class="pro_c_b">
                                        <div class="czfd">
                                            <div class="left">
                                                @{
                                    var support = item.Support;
                                    var against = item.Against;
                                    var sum = support + against;
                                    var slv = 0M;
                                    var alv = 0M;
                                    if (sum == 0)
                                    {
                                        slv = 0;
                                    }
                                    else
                                    {
                                        slv = (decimal)support / sum * 100;
                                    }
                                    if (sum == 0)
                                    {
                                        alv = 0;
                                    }
                                    else
                                    {
                                        alv = (decimal)against / sum * 100;
                                    }
                                                }
                                                <div class="zc">
                                                    <span class="zcl" style=" width:@(slv * 1.6M)px"></span><span class="zclv">@slv.ToString("N0")%</span>
                                                </div>
                                                <div class="fd top15">
                                                    <span class="fdl" style=" width:@(alv * 1.6M)px"></span><span class="fdlv">@alv.ToString("N0")%</span>
                                                </div>
                                            </div>
                                            <div class="right">
                                                @if (item.StopTime < DateTime.Now || item.BonusStatus == BonusStatus.Win)
                                                {
                                                    <span class=" toupiao zc"></span><span class=" toupiao fd"></span>
                                                }
                                                else
                                                {
                                                    <a class="pro_back toupiao zc" schemeid="@item.SchemeId"></a><a class="pro_oppo toupiao fd" schemeid="@item.SchemeId">
                                                    </a>
                                                }
                                            </div>
                                            <div style="clear: both;">
                                            </div>
                                        </div>
                                        <div class="fangan top10">
                                            @{
                                                var tempList = new List<string>();
                                                foreach (var oneCode in indent)
                                                {
                                                    var codeArray = oneCode.AnteCode.Split(',');
                                                    var spArray = oneCode.CurrentSp.Split(',');
                                                    foreach (var code in codeArray)
                                                    {
                                                        var sp = (from s in spArray where s.StartsWith(code) select s).FirstOrDefault();
                                                        tempList.Add(string.Format("{0}_{1}_{2}_{3}", oneCode.MatchId, oneCode.GameType, code, string.IsNullOrEmpty(sp) ? "0" : sp.Split('|')[1]));
                                                    }
                                                }

                                                var codeList = new List<string[]>();
                                                new Common.Algorithms.Combination().Calculate(tempList.ToArray(), 2, (r) =>
                                                {
                                                    if (r[0].Split('_')[0] != r[1].Split('_')[0])
                                                    {
                                                        codeList.Add(r);
                                                    }
                                                });

                                                var codeNameLists = new List<string>();
                                                var money = new List<Decimal>();
                                                foreach (var code in codeList)
                                                {
                                                    if (code.Length != 2) { continue; }

                                                    var tempNameList = new List<string>();
                                                    var tempMoney = 1M;
                                                    foreach (var c in code)
                                                    {
                                                        //code :  140916001_SPF_3_1.25
                                                        var cArray = c.Split('_');
                                                        if (cArray.Length != 4) { continue; }
                                                        var m = indent.FirstOrDefault(p => p.MatchId == cArray[0]);
                                                        if (m == null) { continue; }
                                                        var homeName = m.HomeTeamName.Substring(0, 2);
                                                        var betContent = string.Empty;
                                                        switch (cArray[2])
                                                        {
                                                            case "3":
                                                                betContent = "胜";
                                                                break;
                                                            case "1":
                                                                betContent = "平";
                                                                break;
                                                            case "0":
                                                                betContent = "负";
                                                                break;
                                                        }
                                                        if (cArray[1] == "SPF")
                                                        {
                                                            betContent = "让" + betContent;
                                                        }

                                                        tempNameList.Add(string.Format("{0}_{1}", homeName, betContent));
                                                        tempMoney *= decimal.Parse(cArray[3]);
                                                    }
                                                    codeNameLists.Add(string.Join("|", tempNameList.ToArray()));
                                                    money.Add((tempMoney * 2));
                                                }
                                            }
                                            @{var length = codeNameLists.Count >= 2 ? 2 : 1;}
                                            @for (int ii = 0; ii < length; ii++)
                                            {
                                                string codeName = codeNameLists.Count >= 2 ? codeNameLists[ii] : codeNameLists[0];
                                                var codeArray = codeName.Split('|');
                                                if (length < 2)
                                                {
                                                <div class="pro_cb_b">
                                                    <span>1.</span>
                                                    @for (int _i = 0; _i < codeArray.Length; _i++)
                                                    {
                                                        var cArray = codeArray[_i].Split('_');
                                                        <span class="fa" style="float: none;"><span>@cArray[0]</span><span class="@(cArray[1].StartsWith("让") ? "red" : "green")">[@cArray[1]]</span></span> 
                                                        if (_i == 0)
                                                        {
                                                        <span>x</span>
                                                        }
                                                    }
                                                    <span style="margin-left: 20px;">2串1</span><span class="zhushu">1</span><span>注</span>
                                                </div>
                                                <div class="pro_cb_b">
                                                    2.<span class="fa" style="margin-left: 5px;"><span class="green"></span></span>×<span
                                                        class="fa"><span class="red"></span></span><span style="margin-left: 26px;">2串1</span><span
                                                            class="zhushu" style="margin-left: 30px;"></span><span>注</span></div>
                                                
                                                }
                                                else
                                                {
                                                <div class="pro_cb_b">
                                                    <span>@((b % 2) + 1).</span>
                                                    @for (int _i = 0; _i < codeArray.Length; _i++)
                                                    {
                                                        var cArray = codeArray[_i].Split('_');
                                                        <span class="fa" style="float: none;"><span>@cArray[0]</span><span class="@(cArray[1].StartsWith("让") ? "red" : "green")">[@cArray[1]]</span></span> 
                                                        if (_i == 0)
                                                        {
                                                        <span>x</span>
                                                        }
                                                    }
                                                    <span style="margin-left: 20px;">2串1</span><span class="zhushu">1</span><span>注</span>
                                                </div>
                                                    b++;
                                                }
                                            }
                                            <div class="pro_cb_b">
                                                投入：<span class="red">@(length * 2)</span>元&nbsp;&nbsp;理论奖金：<span class="red lxjj lx">
                                                    @if (money.Count > 1)
                                                    {
                                                        @(money[0] < money[1] ? money[0].ToString("N2") : money[1].ToString("N2"))<span>~</span>@(money[0] > money[1] ? money[0].ToString("N2") : money[1].ToString("N2"))
                                                    }
                                                    else
                                                    {
                                                        @(money[0].ToString("N2"))<span>~</span>@(money[0].ToString("N2"))
                                                    }
                                                </span>元</div>
                                            @{
                                                    string[] s_spArray = new string[5];
                                                    foreach (var inden in indent)
                                                    {
                                                        s_spArray = inden.CurrentSp.Split(',');
                                                    }
                                            }
                                            <div style="margin-left: 7px; margin-top: 5px;">
                                                @if (item.StopTime < DateTime.Now || item.BonusStatus == BonusStatus.Win)
                                                {
                                                    <span class="touzhu">竞猜投注</span> <span title="抄单投注" class="touzhu">抄单投注</span>
                                                }
                                                else
                                                {
                                                    <a href="/buy/jingcai/spf/" target="_blank" class="touzhu touzhu_b">竞猜投注</a> 
                                                    
                                                    if (s_spArray[0] != "")
                                                    {
                                                    <a title="抄单投注" class="touzhu touzhu_o" id="optimization" href="javascript:void
                                                    0">抄单投注</a>
                                                    }
                                                    else
                                                    {
                                                    <span title="抄单投注" class="touzhu">抄单投注</span>
                                                    }
                                                }
                                            </div>
                                            <form target="_blank" action="/buy/optimize" method="post" id="optimize">
                                            <input type="hidden" value="1" name="optimizeForm.multiple" id="op_multiple" />
                                            <input type="hidden" value="" name="optimizeForm.periodId" id="op_period" />
                                            <input type="hidden" value="@length" name="optimizeForm.units" id="op_units" />
                                            <input type="hidden" value="@(length * 2)" name="optimizeForm.schemeCost" id="op_schemecost" />
                                            <input type="hidden" value="2_1" name="optimizeForm.passContent" id="op_pass" />
                                            <input type="hidden" value="" name="optimizeForm.itemsContent" id="op_items" />
                                            <input type="hidden" value="HT" name="playType" id="op_playtype" />
                                            <input type="hidden" value="@item.SchemeId" id="SchemeId" />
                                            <input type="hidden" value="@indent[(a - 1)].LeagueId" id="LeagueId" />
                                            </form>
                                        </div>
                                    </div>
                                </div>
                                @if (item.BonusStatus == BonusStatus.Win)
                                {
                                    <div class="yihzongjiang">
                                    </div>
                                }
                            </li>
                                a++;
                            }
                            if (a == 2)
                            {
                            <li>
                                <div class="pro_title">
                                    推荐方案<span class="icon_pro">@a</span></div>
                                <div class="box">
                                    <div class="pro_d1 top10">
                                        <span class="tj_time"></span><span class="jiantou_w"></span><span class="bsdf_a">
                                        </span><span class="vs">VS</span><span class="bsdf_b"></span>
                                    </div>
                                    <div class="pro_d2 top10">
                                        <span class="tuijian">推&nbsp;&nbsp;&nbsp;&nbsp;荐：</span><span class="jiantou_b"></span><span
                                            style="color: Red; margin-left: 60px; margin-right: 20px;"></span><span style="color: Red;
                                                margin-right: 20px;"></span><span style="color: Red;"></span>
                                    </div>
                                    <div class="div1 pro_bg top10">
                                        <span class="tzbl">投注赔率：</span><span class="tz"></span><span class="tz"></span><span
                                            class="tz"></span><span class="fenxi">析</span>
                                    </div>
                                    <div class="pro_d1 top10">
                                        <span class="tj_time"></span><span class="jiantou_w"></span><span class="bsdf_a">
                                        </span><span class="vs">VS</span><span class="bsdf_b"></span>
                                    </div>
                                    <div class="pro_d2 top10">
                                        <span class="tuijian">推&nbsp;&nbsp;&nbsp;&nbsp;荐：</span><span class="jiantou_b"></span><span
                                            style="color: Red; margin-left: 60px; margin-right: 20px;"></span><span style="color: Red;
                                                margin-right: 20px;"></span><span style="color: Red;"></span>
                                    </div>
                                    <div class="div2 pro_bg top10 ">
                                        <span class="tzbl">投注赔率：</span><span class="tz"></span><span class="tz"></span><span
                                            class="tz"></span><span class="fenxi">析</span>
                                    </div>
                                    <div class="pro_com">
                                        方案支持</div>
                                    <div class="pro_c_b">
                                        <div class="czfd">
                                            <div class="left">
                                                <div class="zc">
                                                    <span class="zcl" style=" width:@(0 * 1.5)px"></span><span class="zclv">%</span>
                                                </div>
                                                <div class="fd top15">
                                                    <span class="fdl" style=" width:@(0 * 1.5)px"></span><span class="fdlv">%</span>
                                                </div>
                                            </div>
                                            <div class="right">
                                                <span class=" toupiao zc"></span><span class=" toupiao fd"></span>
                                            </div>
                                            <div style="clear: both;">
                                            </div>
                                        </div>
                                        <div class="fangan top10">
                                            <div class="pro_cb_b">
                                                1.<span class="fa"><span class="green"></span></span>×<span class="fa"><span class="red"></span></span><span
                                                    style="margin-left: 20px;">2串1</span><span class="zhushu"></span><span>注</span></div>
                                            <div class="pro_cb_b">
                                                2.<span class="fa"><span class="green"></span></span>×<span class="fa"><span class="red"></span></span><span
                                                    style="margin-left: 20px;">2串1</span><span class="zhushu"></span><span>注</span></div>
                                            <div class="pro_cb_b">
                                                投入：<span class="red trzj"></span>元&nbsp;&nbsp;理论奖金：<span class="red lxjj">~</span>元</div>
                                            <div style="margin-left: 7px; margin-top: 5px;">
                                                <span class="touzhu">竞猜投注</span><span class="touzhu">抄单投注</span>@*<a title="抄单投注" id="optimization" class="touzhu"
                                                    href="javascript:void 0">抄单投注</a>*@
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </li>
                            }
                        }
                        else
                        {
                            <li>
                                <div class="pro_title">
                                    推荐方案<span class="icon_pro">1</span></div>
                                <div class="box">
                                    <div class="pro_d1 top10">
                                        <span class="tj_time"></span><span class="jiantou_w"></span><span class="bsdf_a">
                                        </span><span class="vs">VS</span><span class="bsdf_b"></span>
                                    </div>
                                    <div class="pro_d2 top10">
                                        <span class="tuijian">推&nbsp;&nbsp;&nbsp;&nbsp;荐：</span><span class="jiantou_b"></span><span
                                            style="color: Red; margin-left: 60px; margin-right: 20px;"></span><span style="color: Red;
                                                margin-right: 20px;"></span><span style="color: Red;"></span>
                                    </div>
                                    <div class="div1 pro_bg top10">
                                        <span class="tzbl">投注赔率：</span><span class="tz"></span><span class="tz"></span><span
                                            class="tz"></span><span class="fenxi">析</span>
                                    </div>
                                    <div class="pro_d1 top10">
                                        <span class="tj_time"></span><span class="jiantou_w"></span><span class="bsdf_a">
                                        </span><span class="vs">VS</span><span class="bsdf_b"></span>
                                    </div>
                                    <div class="pro_d2 top10">
                                        <span class="tuijian">推&nbsp;&nbsp;&nbsp;&nbsp;荐：</span><span class="jiantou_b"></span><span
                                            style="color: Red; margin-left: 60px; margin-right: 20px;"></span><span style="color: Red;
                                                margin-right: 20px;"></span><span style="color: Red;"></span>
                                    </div>
                                    <div class="div2 pro_bg top10 ">
                                        <span class="tzbl">投注赔率：</span><span class="tz"></span><span class="tz"></span><span
                                            class="tz"></span><span class="fenxi">析</span>
                                    </div>
                                    <div class="pro_com">
                                        方案支持</div>
                                    <div class="pro_c_b">
                                        <div class="czfd">
                                            <div class="left">
                                                <div class="zc">
                                                    <span class="zcl" style=" width:@(0 * 1.5)px"></span><span class="zclv">%</span>
                                                </div>
                                                <div class="fd top15">
                                                    <span class="fdl" style=" width:@(0 * 1.5)px"></span><span class="fdlv">%</span>
                                                </div>
                                            </div>
                                            <div class="right">
                                                <span class=" toupiao zc"></span><span class=" toupiao fd"></span>
                                            </div>
                                            <div style="clear: both;">
                                            </div>
                                        </div>
                                        <div class="fangan top10">
                                            <div class="pro_cb_b">
                                                1.<span class="fa"><span class="green"></span></span>×<span class="fa"><span class="red"></span></span><span
                                                    style="margin-left: 20px;">2串1</span><span class="zhushu"></span><span>注</span></div>
                                            <div class="pro_cb_b">
                                                2.<span class="fa"><span class="green"></span></span>×<span class="fa"><span class="red"></span></span><span
                                                    style="margin-left: 20px;">2串1</span><span class="zhushu"></span><span>注</span></div>
                                            <div class="pro_cb_b">
                                                投入：<span class="red trzj"></span>元&nbsp;&nbsp;理论奖金：<span class="red lxjj">~</span>元</div>
                                            <div style="margin-left: 7px; margin-top: 5px;">
                                                <span class="touzhu">竞猜投注</span><span class="touzhu">抄单投注</span>@*<a title="抄单投注" id="optimization" class="touzhu"
                                                    href="javascript:void 0">抄单投注</a>*@
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="pro_title">
                                    推荐方案<span class="icon_pro">2</span></div>
                                <div class="box">
                                    <div class="pro_d1 top10">
                                        <span class="tj_time"></span><span class="jiantou_w"></span><span class="bsdf_a">
                                        </span><span class="vs">VS</span><span class="bsdf_b"></span>
                                    </div>
                                    <div class="pro_d2 top10">
                                        <span class="tuijian">推&nbsp;&nbsp;&nbsp;&nbsp;荐：</span><span class="jiantou_b"></span><span
                                            style="color: Red; margin-left: 20px;"></span></div>
                                    <div class="pro_bg top10">
                                        <span class="tzbl">投注赔率：</span><span class="tz"></span><span class="tz"></span><span
                                            class="tz"></span><span class="fenxi">析</span>
                                    </div>
                                    <div class="pro_d1 top10">
                                        <span class="tj_time"></span><span class="jiantou_w"></span><span class="bsdf_a">
                                        </span><span class="vs">VS</span><span class="bsdf_b"></span>
                                    </div>
                                    <div class="pro_d2 top10">
                                        <span class="tuijian">推&nbsp;&nbsp;&nbsp;&nbsp;荐：</span><span class="jiantou_b"></span><span
                                            style="color: Red; margin-left: 20px;"></span></div>
                                    <div class="pro_bg top10">
                                        <span class="tzbl">投注赔率：</span><span class="tz"></span><span class="tz"></span><span
                                            class="tz"></span><span class="fenxi">析</span>
                                    </div>
                                    <div class="pro_com">
                                        方案支持</div>
                                    <div class="pro_c_b">
                                        <div class="czfd">
                                            <div class="left">
                                                <div class="zc">
                                                    <span class="zcl" style=" width:@(0 * 1.5)px"></span><span class="zclv">%</span>
                                                </div>
                                                <div class="fd top15">
                                                    <span class="fdl" style=" width:@(0 * 1.5)px"></span><span class="fdlv">%</span>
                                                </div>
                                            </div>
                                            <div class="right">
                                                <span class=" toupiao zc"></span><span class=" toupiao fd"></span>
                                            </div>
                                            <div style="clear: both;">
                                            </div>
                                        </div>
                                        <div class="fangan top10">
                                            <div class="pro_cb_b">
                                                1.<span class="fa"><span class="green"></span></span>×<span class="fa"><span class="red"></span></span><span
                                                    style="margin-left: 20px;">2串1</span><span class="zhushu"></span><span>注</span></div>
                                            <div class="pro_cb_b">
                                                2.<span class="fa"><span class="green"></span></span>×<span class="fa"><span class="red"></span></span><span
                                                    style="margin-left: 20px;">2串1</span><span class="zhushu"></span><span>注</span></div>
                                            <div class="pro_cb_b">
                                                投入：<span class="red trzj"></span>元&nbsp;&nbsp;理论奖金：<span class="red lxjj">~</span>元</div>
                                            <div style="margin-left: 7px; margin-top: 5px;">
                                                <span class="touzhu">竞猜投注</span><span class="touzhu">抄单投注</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </li> 
                        }
                    </ul>
                </div>
                <div style="clear: both;">
                </div>
                <div class="column">
                    <div class="cul_title">
                        推荐名家专栏<span class="en">Recommended famous column</span><a href="AllExpert" target="_blank"
                            class="a">更多推荐名家</a></div>
                    <div>
                        <div class="colleft">
                            <ul>
                                @if (ExperterList != null && ExperterList.TotalCount > 0)
                                {
                                    foreach (var exper in ExperterList.List)
                                    {
                                        if (i % 2 == 0)
                                        {
                                    <li>
                                        <div class="col_left">
                                            @if (!string.IsNullOrEmpty(exper.ExperterHeadImage))
                                            {
                                                <a href="/Expert/PersonSpacial?UserID=@exper.UserId" target="_blank">
                                                    <img src="@exper.ExperterHeadImage" alt="" width="95" height="105" /></a>
                                            }
                                            else
                                            {
                                                <a href="/Expert/PersonSpacial?UserID=@exper.UserId" target="_blank">
                                                    <img src="@ViewHelpers.img("../images/expert/default_header.jpg")" alt="" width="95" height="105" /></a>
                                            }
                                        </div>
                                        <div class="col_right">
                                            <div class="col_f1">
                                                <a href="/Expert/PersonSpacial?UserID=@exper.UserId" target="_blank" class="name_a" title="@exper.DisplayName">@(exper.DisplayName.Length > 10 ? exper.DisplayName.Substring(0, 10) + "…" : exper.DisplayName)</a>
                                                @{
                                            var code = "";
                                            var game = exper.AdeptGameCode;
                                            if (game == "JCZQ")
                                            {
                                                code = "竞彩足球";
                                            }
                                            else { code = exper.AdeptGameCode; }
                                                }
                                                <span class="cz1">@code</span></div>
                                            <div class="col_p1">
                                                <p class="p_height">
                                                    介绍：@(exper.ExperterSummary.Length > 28 ? exper.ExperterSummary.Substring(0, 28) + "..." : exper.ExperterSummary)</p>
                                                <a href="/Expert/PersonSpacial?UserID=@exper.UserId" target="_blank">查看</a>
                                            </div>
                                        </div>
                                    </li>
                                        }
                                        else
                                        {
                                    <li style="margin-left: 15px;">
                                        <div class="col_left">
                                            @if (!string.IsNullOrEmpty(exper.ExperterHeadImage))
                                            {
                                                <a href="/Expert/PersonSpacial?UserID=@exper.UserId" target="_blank">
                                                    <img src="@exper.ExperterHeadImage" alt="" width="95" height="105" /></a>
                                            }
                                            else
                                            {
                                                <a href="/Expert/PersonSpacial?UserID=@exper.UserId" target="_blank">
                                                    <img src="@ViewHelpers.img("../images/expert/default_header.jpg")" alt="" width="95" height="105" /></a>
                                            }
                                        </div>
                                        <div class="col_right">
                                            <div class="col_f2">
                                                <a href="/Expert/PersonSpacial?UserID=@exper.UserId" target="_blank" style=" color:Black;" class="name_a" title="@exper.DisplayName">@(exper.DisplayName.Length > 10 ? exper.DisplayName.Substring(0, 10) + "…" : exper.DisplayName)</a>
                                                @{
                                            var code = "";
                                            var game = exper.AdeptGameCode;
                                            if (game == "JCZQ")
                                            {
                                                code = "竞彩足球";
                                            }
                                            else { code = exper.AdeptGameCode; }
                                                }
                                                <span class="cz2">@code</span></div>
                                            <div class="col_p2">
                                                <p class="p_height">
                                                    介绍：@(exper.ExperterSummary.Length > 28 ? exper.ExperterSummary.Substring(0, 28) + "..." : exper.ExperterSummary)</p>
                                                <a href="/Expert/PersonSpacial?UserID=@exper.UserId" target="_blank">查看</a>
                                            </div>
                                        </div>
                                    </li>
                                        }
                                        i++;
                                    }
                                }
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="right">
                <div class="ml_box">
                    <div class="title">
                        拍砖吐槽</div>
                    <div class="ml_textarea shadow" style="overflow: auto;">
                        <ul>
                            @foreach (var tu in tucao.List)
                            {
                                if (tu.Content != null)
                                {
                                <li style="width: 100%;">
                                    <input type="hidden" id="TuId" value="@tu.Id" />
                                    <div class="tucao">
                                        <span class="tu_p" title="@tu.DisplayName">@(tu.DisplayName.Length > 8 ? tu.DisplayName.Substring(0, 8) + "..." : tu.DisplayName)</span>
                                        <span class="tu_s">
                                            @{
                                    var time = tu.CreateTime;
                                    var timeNow = DateTime.Now;
                                    TimeSpan str = timeNow - time;
                                    var days = str.Days;
                                    var hours = str.Hours;
                                    var minute = str.Minutes;
                                    var second = str.Seconds;
                                    var createtime = "";
                                    if (days == 0 && hours == 0 && minute == 0 && second < 60)
                                    {
                                        createtime = "刚刚";
                                    }
                                    else if (days == 0 && hours == 0 && minute < 60)
                                    {
                                        createtime = minute + "分钟前";
                                    }
                                    else if (days == 0 && hours < 60)
                                    {
                                        createtime = hours + "小时前";
                                    }
                                    else if (days < 24)
                                    {
                                        createtime = days + "天前";
                                    }
                                    else if ((days / 24) > 0)
                                    {
                                        createtime = (days / 24) + "月前";
                                    }
                                    else if ((days / 24 / 12) > 0)
                                    {
                                        createtime = (days / 24 / 12) + "年前";
                                    }
                                            }
                                            @createtime</span>
                                        <div style="clear: both;">
                                        </div>
                                        <div class="chatinfo">
                                            <span class="tu_span"></span>
                                            <div>@tu.Content</div>
                                        </div>
                                    </div>
                                </li>
                                }
                            }
                        </ul>
                    </div>
                    <div class="ml_s">
                        <span class="span3">我有话说</span><span class="span4">评论改变个人观点</span>
                    </div>
                    <div>
                        <textarea class="textarea" name="txtArea" id="txtArea" onkeyup="showCount();"></textarea>
                    </div>
                    <div class="comment">
                        <div class="p">
                            <p class="p1">
                                还可以输入<input name="test2" id="test2" value="60" />个字</p>
                            <p style="font-size: 10px; color: Red;">
                                只限本站用户发表评论</p>
                        </div>
                        <a href="javascript:void(0);" class="combtn" id="Comment">评论</a>
                    </div>
                </div>
                <div class="remlog">
                    <a href="Recommend" target="_blank">
                        <img src="@ViewHelpers.img("../images/expert/remlog.png")" alt="" /></a></div>
                <div class="remmaster">
                    <div class="mas_title">
                        <span>推荐名家命中榜</span>
                        <div class="mas_d">
                            <span class="zhou redd">周</span><span class="yue">月</span><span class="zong">总</span></div>
                    </div>
                    <div class="mas_box shadow" style="display: block;" id="zhou">
                        <ul>
                            @foreach (var exper in expertWeek.List)
                            {
                                if (j % 2 == 0)
                                {
                                <li class="mas_d1"><a href="/Expert/PersonSpacial?UserID=@exper.UserId" title="@exper.DisplayName">@(exper.DisplayName.Length > 8 ? exper.DisplayName.Substring(0, 8) + "…" : exper.DisplayName)</a><span
                                    class="span">
                                    @{
                                    var shoot = (Decimal.Parse(exper.Shooting.ToString("N2")) * 100);
                                    
                                    }
                                    @shoot.ToString("N0")% </span></li>
                                }
                                else
                                {
                                <li class="mas_d2"><a href="/Expert/PersonSpacial?UserID=@exper.UserId" title="@exper.DisplayName">@(exper.DisplayName.Length > 8 ? exper.DisplayName.Substring(0, 8) + "…" : exper.DisplayName)</a><span
                                    class="span">
                                    @{
                                    var shoot = (Decimal.Parse(exper.Shooting.ToString("N2")) * 100);
                                    
                                    }
                                    @shoot.ToString("N0")% </span></li>
                                }
                                j++;
                            }
                        </ul>
                    </div>
                    <div class="mas_box shadow" style="display: none;" id="yue">
                        <ul>
                            @foreach (var exper in expertMonth.List)
                            {
                                if (w % 2 == 0)
                                {
                                <li class="mas_d2"><a href="/Expert/PersonSpacial?UserID=@exper.UserId" title="@exper.DisplayName">@(exper.DisplayName.Length > 8 ? exper.DisplayName.Substring(0, 8) + "…" : exper.DisplayName)</a><span
                                    class="span">
                                    @{
                                    var shoot = (Decimal.Parse(exper.Shooting.ToString("N2")) * 100);
                                    
                                    }
                                    @shoot.ToString("N0")% </span></li>
                                }
                                else
                                {
                                <li class="mas_d1"><a href="/Expert/PersonSpacial?UserID=@exper.UserId" title="@exper.DisplayName">@(exper.DisplayName.Length > 8 ? exper.DisplayName.Substring(0, 8) + "…" : exper.DisplayName)</a><span
                                    class="span">
                                    @{
                                    var shoot = (Decimal.Parse(exper.Shooting.ToString("N2")) * 100);
                                    
                                    }
                                    @shoot.ToString("N0")% </span></li>
                                }
                                w++;
                            }
                        </ul>
                    </div>
                    <div class="mas_box shadow" style="display: none;" id="zong">
                        <ul>
                            @foreach (var exper in expertTotal.List)
                            {
                                if (t % 2 == 0)
                                {
                                <li class="mas_d1"><a href="/Expert/PersonSpacial?UserID=@exper.UserId" title="@exper.DisplayName">@(exper.DisplayName.Length > 8 ? exper.DisplayName.Substring(0, 8) + "…" : exper.DisplayName)</a><span
                                    class="span">
                                    @{
                                    var shoot = (Decimal.Parse(exper.Shooting.ToString("N2")) * 100);
                                    
                                    }
                                    @shoot.ToString("N0")% </span></li>
                                }
                                else
                                {
                                <li class="mas_d2"><a href="/Expert/PersonSpacial?UserID=@exper.UserId" title="@exper.DisplayName">@(exper.DisplayName.Length > 8 ? exper.DisplayName.Substring(0, 8) + "…" : exper.DisplayName)</a><span
                                    class="span">
                                    @{
                                    var shoot = (Decimal.Parse(exper.Shooting.ToString("N2")) * 100);
                                    
                                    }
                                    @shoot.ToString("N0")% </span></li>
                                }
                                t++;
                            }
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div style="clear: both;">
        </div>
        @{Html.RenderAction("Footer", "Expert");}
    </div>
</div>
<script type="text/javascript">
    // JSON转换为字符串
    function JSONstringify(json) {
        if ($.browser.msie) {
            if ($.browser.version == "7.0" || $.browser.version == "6.0") {
                var result = jQuery.parseJSON(json);
            } else {
                result = JSON.stringify(json);
            }
        } else {
            result = JSON.stringify(json);
        }
        return result;
    }
    $(".touzhu_o").click(function () {
        var id = $("#LeagueId").val();
        var content = [];
        var self;
        $(this).parents(".box").find(".pro_bg").each(function (index, item) {
            self = $(item);
            var id = self.find("input[name=matchid]").val();
            var week = self.find("input[name=week]").val();
            var host = self.find("input[name=host]").val();
            var visit = self.find("input[name=visit]").val();
            var lose = self.find("input[name=lose]").val();
            var stoptime = self.find("input[name=stoptime]").val();
            var play = self.find("input[name=play]").val().toLowerCase();
            var obj = { id: id, dan: false, week: week, host: host, visit: visit, lose: lose, stoptime: stoptime.replace(/\//g, "-") };
            var code = [];
            self.find(".tjtz").each(function (i, j) {
                if (i == 0) {
                    code.push(play + "^" + $(j).attr("data"));
                } else {
                    code.push("," + $(j).attr("data"));
                }
            });
            obj.items = code.join("");
            content.push(obj);
        });

        $(this).parents(".box").find("#op_items").val(JSONstringify(content));
        $(this).parents(".box").find("#optimize").submit();
    });

    //周的点击事件，隐藏 总 月
    $(".zhou").click(function () {
        $("#yue").hide();
        $("#zong").hide();
        $("#zhou").show();
        $(this).css("color", "red")
        $(this).siblings().css("color", "black")
    });
    $(".yue").click(function () {
        $("#zhou").hide();
        $("#zong").hide();
        $("#yue").show();
        $(this).css("color", "red")
        $(this).siblings().css("color", "black")
    });
    $(".zong").click(function () {
        $("#yue").hide();
        $("#zhou").hide();
        $("#zong").show();
        $(this).css("color", "red")
        $(this).siblings().css("color", "black")
    });

    $(".r_a").click(function () {

        if ($(".hdSelect").is(":visible")) {
            $(".hdSelect").css("display", "none");
            var time = $(this).text();
            $("#NewV").text(time);
            location.href = "/Expert/Index?time=" + time;
        }
        else {
            $(".hdSelect").css("display", "block");
        }
    });

    $(document).bind('click', function (e) {
        var e = e || window.event; //浏览器兼容性
        var elem = e.target || e.srcElement;
        while (elem) { //循环判断至跟节点，防止点击的是div子元素
            if (elem.id && elem.id == 'NewV') {
                return;
            }
            elem = elem.parentNode;
        }
        $('.hdSelect').css('display', 'none'); //点击的不是div或其子元素
    });

    $("#Comment").click(function () {
        user.isLogin(function (islogin) {
            if (!islogin) {
                loginDialog.Show();
                $("#userName").focus();
            } else {
                var Content = $("#txtArea").val();
                if (Content == "") {
                    alert("内容不能为空！");
                    return false;
                }
                var commentstpye = "10";
                $.post("/Expert/AddTucao", { Content: Content, CommentsTpye: commentstpye }, function (Json) {
                    if (Json.IsSucess == false) {
                        alert(Json.Msg);
                        return false;
                    }
                    else {
                        alert(Json.Msg);
                        $("#txtArea").val("");
                    }
                });
            }
        });
    });

    //支持
    $(".pro_back").click(function () {
        var support = 1;
        var schemeId = $(this).attr("schemeid");
        user.isLogin(function (islogin) {
            if (!islogin) {
                loginDialog.Show();
                $("#userName").focus();
            } else {
                $.post("/Expert/AddOpposeAndSupport", { Support: support, SchemeId: schemeId }, function (Json) {
                    if (Json.IsSucess == false) {
                        alert(Json.Msg);
                        return false;
                    }
                    else {
                        alert(Json.Msg);
                        window.location.href = window.location.href;
                    }
                });
            }
        });
    });

    //反对
    $(".pro_oppo").click(function () {
        var oppose = 2;
        var schemeId = $(this).attr("schemeid");
        user.isLogin(function (islogin) {
            if (!islogin) {
                loginDialog.Show();
                $("#userName").focus();
            } else {
                $.post("/Expert/AddOpposeAndSupport", { Oppose: oppose, SchemeId: schemeId }, function (Json) {
                    if (Json.IsSucess == false) {
                        alert(Json.Msg);
                        return false;
                    }
                    else {
                        alert(Json.Msg);
                        window.location.href = window.location.href;
                    }
                });
            }
        });
    });

</script>
